//>>built
define("xstyle/core/generate",["xstyle/core/elemental","put-selector/put","xstyle/core/utils","xstyle/core/expression","xstyle/core/base"],function(z,w,A,J,K){function m(a,d){a=a.sort?a:[a];return function(c,k,b){var e=c,B;"content"in c||(c.content=void 0);if(void 0===b){var g=(c._contentNode||c).childNodes||0,h=g[0];if(h){var u=t.createDocumentFragment();do u.appendChild(h);while(h=g[0]);c.content=u}if(c._contentNode){c._contentNode=void 0;try{c.innerHTML=""}catch(p){}}}for(var D=0,E=[c],C=[],g=
0,h=a.length;g<h;g++){var F=f,f=a[g];try{if(f.eachProperty){if(f.args)if("("==f.operator){var q=a[g+1];G(f,q,e,function(a,b,c){L(a,b,c,d)})}else{var n=f.args[0];if("string"===typeof n){var r=n.split("\x3d");try{e.setAttribute(r[0],r[1])}catch(p){console.error(p)}}else{var m=n[0].replace(/=$/,""),x=n[1];"("==x.operator?G(n[1],m,e,function(a,b,c){M(a,b,c,d)}):e.setAttribute(m,x.value)}}}else if("string"==typeof f){"\x3d"==f.charAt(0)&&(f=f.slice(1));var l=e,q=a[g+1],r=[];f.replace(/([,\n]+)?([\t ]*)?(\.|#)?([-\w%$|\.\#]+)(?:\[([^\]=]+)=?['"]?([^\]'"]*)['"]?\])?/g,
function(){r.push(arguments)});for(var y=0;y<r.length;y++)(function(a,g,h,f,m,u,t){function p(){var a=l._contentNode;a&&(a.innerHTML="",l=a)}g?(a=h?h.length:0,a>D?(p(),E[a]=l):l=E[a]||l,D=a):p();var n;if(f)n=(F&&F.args?"":"span")+f+m;else{f=m.match(/^[-\w]+/);if(!f)throw new SyntaxError("Unable to parse selector",m);f=f[0];var v;y===r.length-1&&q&&q.selector?(q.bases||A.extend(q,f),v=q):v=d.getDefinition(f);v&&(v.then||v.newElement)?l=function(a,b,c,f){var e,d;A.when(v&&v.newElement&&v.newElement(),
function(a){(e=a)?(c=c.slice(f.length))&&w(e,c):e=w(c);if(d){d.parentNode.replaceChild(e,d);a=d.childNodes;var b;for(e=e._contentNode||e;b=a[0];)e.appendChild(b)}});if(e)return a.insertBefore(e,b||null);d=w("span");return a.insertBefore(d,b||null)}(l,b,m,f):n=m}n&&(l=w(b||l,(b?"-":"")+n));b=null;u&&l.setAttribute(u,""===t?u:t);k&&(l.item=k);B=B||l;(y<r.length-1||l!=e&&l!=c)&&C.push(y==r.length-1&&q&&q.selector,l);e=l}).apply(this,r[y])}else e.appendChild(t.createTextNode(f.value))}catch(p){console.error(p,
p.stack),e.innerHTML&&(e.innerHTML=""),e.appendChild(t.createTextNode(p))}}for(;f=C.pop();)z.update(f,C.pop());return B}}function G(a,d,c,k){var b,e;d&&d.eachProperty?(w(c,b=d.selector),e=d):(w(c,b=a.selector||(a.selector=".-xbind-"+N++)),e=a);var m=a.getArgs()[0],g=a.expressionResult,h=a.expressionDefinition;h||(h=a.expressionDefinition=J.evaluate(a.parent,m),g=h.valueOf(),z.addInputConnector(e,h),function(b,c,d){a.expressionResult=g;d.dependencyOf&&d.dependencyOf({invalidate:function(a){a=a?z.matchesRule(a.elements[0],
e)?a.elements:a.elements[0].querySelectorAll(c):document.querySelectorAll(c);for(var g=0,f=a.length;g<f;g++)k(a[g],b,d.valueOf())}})}(d,b,h));k(c,d,g)}function x(a,d,c,k){return A.when(a,function(a){a&&a.forRule&&(a=a.forRule(d));a&&a.forElement&&(a=a.forElement(c));k(a)})}function M(a,d,c,k){x(c,k,a,function(b){a.setAttribute(d,b)})}function L(a,d,c,k){a._defaultBinding=!0;if(c&&c.then&&"INPUT"!==a.tagName)try{a.appendChild(t.createTextNode("Loading"))}catch(b){}x(c,k,a,function(b){if(a._defaultBinding)if(H(a),
a.childNodes.length&&(a.innerHTML=""),b&&b.sort)if(b.isSequence)m(b,k)(a);else{var c=d&&d.definitions&&d.definitions.each,x=k.newRule(),c=c?m(c,x):function(a,b,c){return w(c||a,(c?"-":"")+(O[a.tagName]||"span"),""+b)},g=[],h;b.track&&(b=b.track(),h=b.tracking);b.forEach(function(b){g.push(c(a,b,null))});if(b.on)var u=b.on("add,delete,update",function(b){var d=b.target,e=b.previousIndex;b=b.index;if(-1<e){var h=g[e];H(h,!0);h.parentNode.removeChild(h);g.splice(e,1)}-1<b&&g.splice(b,0,c(a,d,g[b]||null))});
if(h=h||u)a.xcleanup=function(){h.remove()}}else b&&b.nodeType?a.appendChild(b):(b=void 0===b?"":b,a.tagName in P?"checkbox"===a.type?a.checked=b:a.value=b:a.appendChild(t.createTextNode(b)))})}function H(a,d){a.xcleanup&&a.xcleanup(d);for(var c=a.getElementsByTagName("*"),k=0,b=c.length;k<b;k++){var e=c[k];e.xcleanup&&e.xcleanup(!0)}}function I(a,d){return m(d,K)(a)}var O={TABLE:"tr",TBODY:"tr",TR:"td",UL:"li",OL:"li",SELECT:"option"},P={INPUT:1,TEXTAREA:1,SELECT:1},t=document,N=1;I.forSelector=
m;return I});