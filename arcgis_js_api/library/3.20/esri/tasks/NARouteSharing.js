// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.20/esri/copyright.txt for details.
//>>built
define("esri/tasks/NARouteSharing","dojo/_base/declare dojo/_base/array dojo/json dojo/Deferred dojo/promise/all dojo/_base/lang dojo/i18n!../nls/jsapi dojo/number ../request ../graphic ../renderers/SimpleRenderer ../renderers/UniqueValueRenderer ../symbols/PictureMarkerSymbol ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../arcgis/Portal ../tasks/RouteParameters ../tasks/RouteResult ../SpatialReference ../tasks/FeatureSet ../tasks/GeometryService ../tasks/ProjectParameters ../geometry/webMercatorUtils".split(" "),
function(S,H,w,v,O,m,n,T,I,P,x,u,r,y,D,U,V,W,E,L,X,Y,Q){return S(null,{declaredClass:"esri.tasks.NARouteSharing",portal:null,outSR:null,firstStopSymbol:{angle:0,xoffset:0,yoffset:9,type:"esriPMS",width:17,height:24,imageData:"PHN2ZyB3aWR0aD0iMjEiIGhlaWdodD0iMjkiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PHJhZGlhbEdyYWRpZW50IGlkPSJzdmdfMyIgc3ByZWFkTWV0aG9kPSJwYWQiIGN4PSIwLjM4MTUzIiBjeT0iMC4yOTY4OCIgcj0iMC41Ij48c3RvcCBzdG9wLWNvbG9yPSIjNmJjMjc4IiBzdG9wLW9wYWNpdHk9IjAuOTg4MjgxIiBvZmZzZXQ9IjAiLz48c3RvcCBzdG9wLWNvbG9yPSIjMmU5ZjNkIiBzdG9wLW9wYWNpdHk9IjAuOTkyMTg4IiBvZmZzZXQ9IjEiLz48L3JhZGlhbEdyYWRpZW50PjwvZGVmcz48Zz48ZyBzdHJva2U9Im51bGwiIGlkPSJzdmdfMSI+PHBhdGggc3Ryb2tlPSIjMWM1ZTI0IiBzdHJva2Utb3BhY2l0eT0iMC43IiBmaWxsPSJ1cmwoI3N2Z18zKSIgc3Ryb2tlLWxpbmVqb2luPSJudWxsIiBzdHJva2UtbGluZWNhcD0ibnVsbCIgZD0ibTAuNTYyMTIsMTAuNjM0NTIxYzAsLTUuNTY0OSA0LjQ1NjcxMSwtMTAuMDcyNDYgOS45NTg4MjgsLTEwLjA3MjQ2YzUuNTAyMTA2LDAgOS45NTg4MjgsNC41MDc1NyA5Ljk1ODgyOCwxMC4wNzI0NmMwLDIuNzgyNDUgLTEuMTE0MTgsNS4zMDA1NyAtMi45MTYxMTYsNy4xMjMwNzNjLTAuOTAwOTY4LDAuOTExMjQ2IC0yLjk0MDQwOCwyLjI2NjE2MSAtNC43NDEzNDgsNC43MTI0NWMtMS44MDA5MjksMi40NDYyODkgLTIuMTkxMDQzLDYuMDM2ODc1IC0yLjI0NTYxNSw2LjAzNDUxNWMtMC4wNTQ1NjIsLTAuMDAyMzYgLTAuOTg1NzY3LC0zLjc3MjU1NCAtMi41OTczMzEsLTYuMTkzMzY1Yy0xLjYxMTU4NCwtMi40MjA4MSAtMy42MDAxNDEsLTMuNjQyMzU0IC00LjUwMTEwOSwtNC41NTM2Yy0xLjgwMTk0NiwtMS44MjI1MDIgLTIuOTE2MTE2LC00LjM0MDYyMyAtMi45MTYxMTYsLTcuMTIzMDczbDAsMGwtMC4wMDAwMjEsMHoiIGlkPSJzdmdfMiIvPjwvZz48ZWxsaXBzZSByeT0iNCIgcng9IjQiIGlkPSJzdmdfODciIGN5PSIxMC4zNDM3NSIgY3g9IjEwLjUiIHN0cm9rZS1vcGFjaXR5PSJudWxsIiBzdHJva2Utd2lkdGg9Im51bGwiIHN0cm9rZT0iIzFjNWUyNCIgZmlsbD0iI2ZmZmZmZiIvPjwvZz48L3N2Zz4\x3d",
contentType:"image/svg+xml"},interimStopSymbol:{angle:0,xoffset:0,yoffset:9,type:"esriPMS",width:17,height:24,imageData:"PHN2ZyB3aWR0aD0iMjEiIGhlaWdodD0iMjkiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+DQogPGRlZnM+DQogIDxyYWRpYWxHcmFkaWVudCBpZD0ic3ZnXzMiIHNwcmVhZE1ldGhvZD0icGFkIiBjeD0iMC4zODE1MyIgY3k9IjAuMjk2ODgiIHI9IjAuNSI+DQogICA8c3RvcCBzdG9wLWNvbG9yPSIjNjdBN0U0IiBzdG9wLW9wYWNpdHk9IjAuOTg4MjgxIiBvZmZzZXQ9IjAiLz4NCiAgIDxzdG9wIHN0b3AtY29sb3I9IiMxQjgxRDIiIHN0b3Atb3BhY2l0eT0iMC45OTIxODgiIG9mZnNldD0iMSIvPg0KICA8L3JhZGlhbEdyYWRpZW50Pg0KIDwvZGVmcz4NCiA8Zz4NCiAgPHRpdGxlPjE8L3RpdGxlPg0KICA8ZyBzdHJva2U9Im51bGwiIGlkPSJzdmdfMSI+DQogICA8cGF0aCBzdHJva2U9IiMxYzVlMjQiIHN0cm9rZS1vcGFjaXR5PSIwLjciIGZpbGw9InVybCgjc3ZnXzMpIiBzdHJva2UtbGluZWpvaW49Im51bGwiIHN0cm9rZS1saW5lY2FwPSJudWxsIiBkPSJtMC41NjIxMiwxMC42MzQ1MjFjMCwtNS41NjQ5IDQuNDU2NzExLC0xMC4wNzI0NiA5Ljk1ODgyOCwtMTAuMDcyNDZjNS41MDIxMDYsMCA5Ljk1ODgyOCw0LjUwNzU3IDkuOTU4ODI4LDEwLjA3MjQ2YzAsMi43ODI0NSAtMS4xMTQxOCw1LjMwMDU3IC0yLjkxNjExNiw3LjEyMzA3M2MtMC45MDA5NjgsMC45MTEyNDYgLTIuOTQwNDA4LDIuMjY2MTYxIC00Ljc0MTM0OCw0LjcxMjQ1Yy0xLjgwMDkyOSwyLjQ0NjI4OSAtMi4xOTEwNDMsNi4wMzY4NzUgLTIuMjQ1NjE1LDYuMDM0NTE1Yy0wLjA1NDU2MiwtMC4wMDIzNiAtMC45ODU3NjcsLTMuNzcyNTU0IC0yLjU5NzMzMSwtNi4xOTMzNjVjLTEuNjExNTg0LC0yLjQyMDgxIC0zLjYwMDE0MSwtMy42NDIzNTQgLTQuNTAxMTA5LC00LjU1MzZjLTEuODAxOTQ2LC0xLjgyMjUwMiAtMi45MTYxMTYsLTQuMzQwNjIzIC0yLjkxNjExNiwtNy4xMjMwNzNsMCwwbC0wLjAwMDAyMSwweiIgaWQ9InN2Z18yIi8+DQogIDwvZz4NCiA8L2c+DQo8L3N2Zz4NCg\x3d\x3d",
contentType:"image/svg+xml"},lastStopSymbol:{angle:0,xoffset:0,yoffset:9,type:"esriPMS",width:17,height:24,imageData:"PHN2ZyB3aWR0aD0iMjEiIGhlaWdodD0iMjkiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PHJhZGlhbEdyYWRpZW50IHI9IjAuNSIgY3k9IjAuMzU1NDciIGN4PSIwLjMzMjAzIiBzcHJlYWRNZXRob2Q9InBhZCIgaWQ9InN2Z182Ij48c3RvcCBvZmZzZXQ9IjAiIHN0b3Atb3BhY2l0eT0iMC45OTYwOSIgc3RvcC1jb2xvcj0iI2U0ODY2NyIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1vcGFjaXR5PSIwLjk5NjA5IiBzdG9wLWNvbG9yPSIjYzkzYTE2Ii8+PC9yYWRpYWxHcmFkaWVudD48L2RlZnM+PGc+PGcgc3Ryb2tlPSJudWxsIiBpZD0ic3ZnXzEiPjxwYXRoIHN0cm9rZT0iIzg0MjMwYSIgc3Ryb2tlLW9wYWNpdHk9IjAuNyIgZmlsbD0idXJsKCNzdmdfNikiIHN0cm9rZS1saW5lam9pbj0ibnVsbCIgc3Ryb2tlLWxpbmVjYXA9Im51bGwiIGQ9Im0wLjU2MjEyLDEwLjYzNDUyYzAsLTUuNTY0OSA0LjQ1NjcxLC0xMC4wNzI0NiA5Ljk1ODgzLC0xMC4wNzI0NmM1LjUwMjEsMCA5Ljk1ODgzLDQuNTA3NTcgOS45NTg4MywxMC4wNzI0NmMwLDIuNzgyNDUgLTEuMTE0MTgsNS4zMDA1NyAtMi45MTYxMiw3LjEyMzA3Yy0wLjkwMDk3LDAuOTExMjUgLTIuOTQwNDEsMi4yNjYxNiAtNC43NDEzNSw0LjcxMjQ1Yy0xLjgwMDkzLDIuNDQ2MjkgLTIuMTkxMDQsNi4wMzY4OCAtMi4yNDU2MSw2LjAzNDUyYy0wLjA1NDU2LC0wLjAwMjM2IC0wLjk4NTc3LC0zLjc3MjU2IC0yLjU5NzMzLC02LjE5MzM3Yy0xLjYxMTU5LC0yLjQyMDgxIC0zLjYwMDE0LC0zLjY0MjM1IC00LjUwMTExLC00LjU1MzZjLTEuODAxOTUsLTEuODIyNSAtMi45MTYxMiwtNC4zNDA2MiAtMi45MTYxMiwtNy4xMjMwN2wwLDBsLTAuMDAwMDIsMHoiIGlkPSJzdmdfMiIvPjwvZz48cmVjdCBpZD0ic3ZnXzkiIGhlaWdodD0iOCIgd2lkdGg9IjgiIHk9IjYuNSIgeD0iNi40OSIgc3Ryb2tlLW9wYWNpdHk9Im51bGwiIHN0cm9rZS13aWR0aD0ibnVsbCIgc3Ryb2tlPSIjODQyMzBhIiBmaWxsPSIjZmZmZmZmIi8+PC9nPjwvc3ZnPg\x3d\x3d",
contentType:"image/svg+xml"},unlocatedStopSymbol:{angle:0,xoffset:0,yoffset:9,type:"esriPMS",width:17,height:24,imageData:"PHN2ZyB3aWR0aD0iMjEiIGhlaWdodD0iMjkiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PHJhZGlhbEdyYWRpZW50IHI9IjAuNSIgY3k9IjAuMzU1NDciIGN4PSIwLjMzMjAzIiBzcHJlYWRNZXRob2Q9InBhZCIgaWQ9InN2Z18xMCI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLW9wYWNpdHk9IjAuOTkyMTkiIHN0b3AtY29sb3I9IiNlMmUyZTIiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3Atb3BhY2l0eT0iMC45ODQzOCIgc3RvcC1jb2xvcj0iIzllOWU5ZSIvPjwvcmFkaWFsR3JhZGllbnQ+PC9kZWZzPjxnPjxnIHN0cm9rZT0ibnVsbCIgaWQ9InN2Z18xIj48cGF0aCBzdHJva2U9IiM2NjY2NjYiIHN0cm9rZS1vcGFjaXR5PSIwLjciIGZpbGw9InVybCgjc3ZnXzEwKSIgc3Ryb2tlLWxpbmVqb2luPSJudWxsIiBzdHJva2UtbGluZWNhcD0ibnVsbCIgZD0ibTAuNTYyMTIsMTAuNjM0NTJjMCwtNS41NjQ5IDQuNDU2NzEsLTEwLjA3MjQ2IDkuOTU4ODMsLTEwLjA3MjQ2YzUuNTAyMSwwIDkuOTU4ODMsNC41MDc1NyA5Ljk1ODgzLDEwLjA3MjQ2YzAsMi43ODI0NSAtMS4xMTQxOCw1LjMwMDU3IC0yLjkxNjEyLDcuMTIzMDdjLTAuOTAwOTcsMC45MTEyNSAtMi45NDA0MSwyLjI2NjE2IC00Ljc0MTM1LDQuNzEyNDVjLTEuODAwOTMsMi40NDYyOSAtMi4xOTEwNCw2LjAzNjg4IC0yLjI0NTYxLDYuMDM0NTJjLTAuMDU0NTYsLTAuMDAyMzYgLTAuOTg1NzcsLTMuNzcyNTYgLTIuNTk3MzMsLTYuMTkzMzdjLTEuNjExNTksLTIuNDIwODEgLTMuNjAwMTQsLTMuNjQyMzUgLTQuNTAxMTEsLTQuNTUzNmMtMS44MDE5NSwtMS44MjI1IC0yLjkxNjEyLC00LjM0MDYyIC0yLjkxNjEyLC03LjEyMzA3bDAsMGwtMC4wMDAwMiwweiIgaWQ9InN2Z18yIi8+PC9nPjxyZWN0IHRyYW5zZm9ybT0icm90YXRlKC00NSAxMC41LDEwLjUpICIgc3Ryb2tlPSIjZTJlMmUyIiBpZD0ic3ZnXzExIiBoZWlnaHQ9IjEwIiB3aWR0aD0iMiIgeT0iNS42IiB4PSI5LjUiIHN0cm9rZS13aWR0aD0iMCIgZmlsbD0iIzY2NjY2NiIvPjxyZWN0IHRyYW5zZm9ybT0icm90YXRlKDQ1IDEwLjUsMTAuNSkgIiBzdHJva2U9IiNlMmUyZTIiIGlkPSJzdmdfMTIiIGhlaWdodD0iMTAiIHdpZHRoPSIyIiB5PSI1LjYiIHg9IjkuNSIgc3Ryb2tlLXdpZHRoPSIwIiBmaWxsPSIjNjY2NjY2Ii8+PC9nPjwvc3ZnPg\x3d\x3d",
contentType:"image/svg+xml"},waypointSymbol:{color:[255,255,255,255],size:10,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSCircle",outline:{color:[20,89,127,255],width:2.5,type:"esriSLS",style:"esriSLSSolid"}},directionSymbol:{color:[0,122,194,255],width:6,type:"esriSLS",style:"esriSLSSolid"},directionPointSymbol:{color:[100,100,255,255],size:12,type:"esriSMS",style:"esriSMSCircle",outline:{color:[255,255,255,255],width:2,type:"esriSLS",style:"esriSLSSolid"}},directionEventSymbol:{color:[100,
255,100,255],size:8,type:"esriSMS",style:"esriSMSCircle",outline:{color:[0,69,0,255],width:1,type:"esriSLS",style:"esriSLSSolid"}},directionLineSymbol:{color:[0,122,194,255],width:6,type:"esriSLS",style:"esriSLSSolid"},routeSymbol:{color:[20,89,127,255],width:8,type:"esriSLS",style:"esriSLSSolid"},barrierRenderer:new u({type:"uniqueValue",field1:"BarrierType",defaultSymbol:{type:"esriPMS",imageData:"PHN2ZyB3aWR0aD0iMjIyIiBoZWlnaHQ9IjIyMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGc+CjxlbGxpcHNlIGZpbGw9IiNmZjAwMDAiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLXdpZHRoPSIyMCIgY3g9IjExMiIgY3k9IjExMSIgaWQ9InN2Z181IiByeD0iMTAwIiByeT0iMTAwIi8+CjxlbGxpcHNlIGZpbGw9IiNmZjAwMDAiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLXdpZHRoPSIyMCIgY3g9IjExMiIgY3k9IjExMSIgaWQ9InN2Z182IiByeD0iOTUiIHJ5PSI5NSIvPgo8cmVjdCBmaWxsPSIjZmYwMDAwIiBzdHJva2Utd2lkdGg9IjIwIiB4PSI2NC41IiB5PSIxMDIiIHdpZHRoPSI5NSIgaGVpZ2h0PSIxOCIgaWQ9InN2Z183IiBzdHJva2U9IiNmZmZmZmYiLz4KPC9nPgo8L3N2Zz4\x3d",
contentType:"image/svg+xml",width:18,height:18},uniqueValueInfos:[{value:"2",symbol:{type:"esriPMS",imageData:"PHN2ZyB3aWR0aD0iMjg2IiBoZWlnaHQ9IjI1NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGc+CjxwYXRoIGZpbGw9IiNmZmYiIHN0cm9rZS13aWR0aD0iMTAiIGQ9Im04Ljc0OTk5MiwyNTEuNzQ5OTk3bDEzNC45OTk5OTgsLTI0MS45OTk5OThsMTM0Ljk5OTk5OCwyNDEuOTk5OTk4bC0yNjkuOTk5OTk1LDBsLTAuMDAwMDAxLDB6IiBpZD0ic3ZnXzEiIHN0cm9rZT0iIzAwMCIvPgo8cGF0aCBzdHJva2U9IiNmZmYiIGZpbGw9IiNmZjAwMDAiIHN0cm9rZS13aWR0aD0iMTUiIGQ9Im0yMy41MDAwMDQsMjQyLjUwMDAwNWwxMTkuOTk5OTkyLC0yMTUuOTk5OTk5bDExOS45OTk5OTIsMjE1Ljk5OTk5OWwtMjM5Ljk5OTk4MywwbC0wLjAwMDAwMSwweiIgaWQ9InN2Z18yIi8+Cjx0ZXh0IGZvbnQtd2VpZ2h0PSJib2xkIiBmaWxsPSIjZmZmZmZmIiBzdHJva2U9IiNmZjAwMDAiIHN0cm9rZS13aWR0aD0iMCIgeD0iMTA5IiB5PSIyMjIuNzUiIGlkPSJzdmdfNSIgZm9udC1zaXplPSIxODAiIGZvbnQtZmFtaWx5PSJHZW9yZ2lhLCBUaW1lcywgJ1RpbWVzIE5ldyBSb21hbicsIHNlcmlmIiB0ZXh0LWFuY2hvcj0ic3RhcnQiIHhtbDpzcGFjZT0icHJlc2VydmUiPiE8L3RleHQ+CjwvZz4KPC9zdmc+",
contentType:"image/svg+xml",width:19,height:18}}]}),polylineBarrierRenderer:new u({type:"uniqueValue",field1:"BarrierType",defaultSymbol:{color:[255,0,0,184],width:7.5,type:"esriSLS",style:"esriSLSSolid"},uniqueValueInfos:[{value:"1",symbol:{color:[255,85,0,184],width:7.5,type:"esriSLS",style:"esriSLSSolid"}}]}),polygonBarrierRenderer:new u({type:"uniqueValue",field1:"BarrierType",defaultSymbol:{color:[255,0,0,156],outline:{color:[255,0,0,153],width:2.4,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",
style:"esriSFSSolid"},uniqueValueInfos:[{value:"1",symbol:{color:[255,170,0,156],outline:{color:[255,0,0,153],width:7.5,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",style:"esriSFSSolid"}}]}),_geometryService:null,_jsonStringFieldSize:1048576,constructor:function(c,a){c&&(this.portal=new U.Portal(c),this._outSR=a)},getFolders:function(){return this.portal?this.portal.signIn().then(m.hitch(this,function(){return this.portal.getPortalUser().getFolders()},!1)).then(m.hitch(this,function(c){var a=
this.portal.getPortalUser();c=c||[];c.splice(0,0,{created:a.created,portal:this.portal,title:a.username+" ("+n.networkAnalysis.sharing.rootFolder+")",url:a.userContentUrl});return c})):[]},canCreateItem:function(){var c=new v;this.portal?this.portal.signIn().then(m.hitch(this,function(){c.resolve(-1<(this.portal.getPortalUser().privileges||[]).indexOf("portal:user:createItem"))}),c.reject):c.reject(Error("No URL to a Portal instance or ArcGIS Online was specified at construction time."));return c.promise},
toMinutes:function(c,a,e){c=c||0;switch(a){case "esriNAUSeconds":c/=Math.pow(60,e?-1:1);break;case "esriNAUHours":c*=Math.pow(60,e?-1:1);break;case "esriNAUDays":c*=Math.pow(1440,e?-1:1)}return c},fromMinutes:function(c,a){return this.toMinutes(c,a,!0)},toMeters:function(c,a,e){c=c||0;switch((a||"").replace("esriNAU","esri")){case "esriInches":c*=Math.pow(.0254,e?-1:1);break;case "esriFeet":c*=Math.pow(.3048,e?-1:1);break;case "esriYards":c*=Math.pow(.9144,e?-1:1);break;case "esriMiles":c*=Math.pow(1609.344,
e?-1:1);break;case "esriNauticalMiles":c*=Math.pow(1851.995396854,e?-1:1);break;case "esriMillimeters":c/=Math.pow(1E3,e?-1:1);break;case "esriCentimeters":c/=Math.pow(100,e?-1:1);break;case "esriKilometers":c*=Math.pow(1E3,e?-1:1);break;case "esriDecimeters":c/=Math.pow(10,e?-1:1)}return c},fromMeters:function(c,a){return this.toMeters(c,a,!0)},toGeolocalTime:function(c,a){return void 0===c||null===c?void 0:c+6E4*(a||0)},toUTCTime:function(c,a){-22091616E5===c&&(c=void 0);return null!==a&&void 0!==
a?c-6E4*a:c},getUTCOffset:function(c,a){return null!==a&&void 0!==a&&0<a?(c-a)/60/1E3:void 0},getAttributeUnits:function(c,a){for(var e=a.networkDataset.networkAttributes,g,b=0;b<e.length;b++)if(e[b].name===c&&"esriNAUTCost"===e[b].usageType){g=e[b].units;break}return g},addAttributePrefix:function(c,a){var e={},g;for(g in c)c.hasOwnProperty(g)&&(e[a+g]=c[g]);return e},project:function(c,a,e){var g=new v;if(c&&c.length&&a&&e&&a.wkid!==e.wkid){var b=a instanceof E?a:new E(a),h=e instanceof E?e:new E(e);
if(Q.canProject(b,h))H.forEach(c,function(a,d){a.geometry&&(a.geometry.spatialReference||(a.geometry.spatialReference=b.toJson()),a=new P(a),a.setGeometry(Q.project(a.geometry,h)),c[d]=a.toJson())}),g.resolve(c);else if(!this._geometryService&&this.portal&&this.portal.helperServices.geometry&&(this._geometryService=new X(this.portal.helperServices.geometry.url)),this._geometryService){var d=m.hitch(this,function(a,b){var d=new Y,e=new v;d.outSR=h;d.geometries=[a.geometry];this._geometryService.project(d).then(m.hitch(this,
function(d){a.setGeometry(d[0]);c[b]=a.toJson();e.resolve()}),e.reject);return e.promise}),f=[];H.forEach(c,m.hitch(this,function(a,c){a.geometry&&(a.geometry.spatialReference||(a.geometry.spatialReference=b.toJson()),f.push(d(new P(a),c)))}));O(f).then(g.resolve,g.reject)}else g.resolve(c)}else g.resolve(c);return g.promise},load:function(c,a){var e=new v,g=m.hitch(this,this.fromMeters),b=m.hitch(this,this.fromMinutes),h=m.hitch(this,this.addAttributePrefix);this.portal?this.portal.signIn().then(m.hitch(this,
function(){var d=this.portal.getPortalUser(),f=d.userContentUrl.replace(/\/users\/.+\/?$/,"/items/");I({url:f+c,content:{f:"json"},callbackParamName:"callback"}).then(m.hitch(this,function(k){I({url:f+c+"/data",content:{f:"json"},callbackParamName:"callback"}).then(m.hitch(this,function(c){var f=function(a){for(var b=0;b<c.layers.length;b++)if(c.layers[b].layerDefinition.name===a)return c.layers[b]},l=f("Directions"),J=l&&l.featureSet.features||[],p=f("DirectionEvents"),R=p&&p.featureSet.features||
[],M=f("DirectionPoints"),z=M&&M.featureSet.features||[],q=(p=f("DirectionLines"))&&p.featureSet.features||[],K=f("Stops"),t=K&&K.featureSet.features||[],r=(p=f("PolygonBarriers"))&&p.featureSet.features||[],v=(p=f("PolylineBarriers"))&&p.featureSet.features||[],x=(p=f("Barriers"))&&p.featureSet.features||[],F=(f=f("RouteInfo"))&&f.featureSet.features,p=t&&t.length?K.featureSet.spatialReference||t[0].geometry.spatialReference:null,A=this._outSR?this._outSR:p,u=[this.project(J,p,this._outSR),this.project(R,
p,this._outSR),this.project(z,p,this._outSR),this.project(q,p,this._outSR),this.project(t,p,this._outSR),this.project(r,p,this._outSR),this.project(v,p,this._outSR),this.project(x,p,this._outSR),this.project(F,p,this._outSR)],G=f&&f.layerDefinition&&[{geometry:f.layerDefinition.extent}];G&&u.push(this.project(G,p,this._outSR));O(u).then(m.hitch(this,function(){F=F&&F[0];G=G&&G[0].geometry;var c=F&&F.attributes,f=c?w.parse(c.AnalysisSettings):void 0,C=f?f.travelMode.timeAttributeName:void 0,p=f?f.travelMode.distanceAttributeName:
void 0,B=this.getAttributeUnits(C,a),u=this.getAttributeUnits(p,a),y=a.directionsLengthUnits,I=c?c.Messages:void 0,D=[],H=(l||M)&&c?{directions:{routeId:1,routeName:c.RouteName,summary:{totalLength:this.fromMeters(c.TotalMeters,y),totalTime:this.fromMinutes(c.TotalMinutes,B),totalDriveTime:this.fromMinutes(c.TotalMinutes-c.TotalWaitMinutes,B),envelope:G},spatialReference:A,geometryType:"esriGeometryPolyline",features:m.hitch(this,function(){var a=(c.Version||"0.0.0").split("."),b;if("0"===a[0])return this._loadDirectionsFeatureSet(J,
R,y,B,A);if("1"===a[0]){for(a=0;a<z.length;a++)if(void 0!==z[a].attributes.StopID)for(b=0;b<t.length;b++)if(t[b].attributes[K.layerDefinition.objectIdField||"__OBJECTID"]==z[a].attributes.StopID){z[a].attributes.StopSequence=t[b].attributes.Sequence;break}for(a=0;a<q.length;a++)if(void 0!==q[a].attributes.DirectionPointID)for(b=0;b<z.length;b++)if(z[b].attributes[M.layerDefinition.objectIdField||"__OBJECTID"]==q[a].attributes.DirectionPointID){q[a].attributes.DirectionSequence=z[b].attributes.Sequence;
break}for(a=0;a<q.length-1;){for(b=a+1;b<q.length;)q[a].attributes.DirectionPointID===q[b].attributes.DirectionPointID&&(q[a].geometry&&q[a].geometry.paths[0]?q[a].geometry.paths[0]=q[a].geometry.paths[0].concat(q[b].geometry.paths[0]||[]):q[a].geometry=q[b].geometry,q[a].attributes.DirectionLineType=this._lineTypeStringToLineTypeCode("esriDLTSegment"),q[a].attributes.Meters+=q[b].attributes.Meters||0,q[a].attributes.Minutes+=q[b].attributes.Minutes||0,q[a].attributes.ToLevel=q[b].attributes.ToLevel||
q[a].attributes.ToLevel,q.splice(b,1)),b++;a++}return this._loadDirectionsFeatureSet_100(z,q,t,y,B,A)}e.reject(Error("Unsupported version of route layer."))})()},stops:m.hitch(this,function(){for(var a=[],c=0;c<t.length;c++){var b=t[c].attributes,d={geometry:t[c].geometry,attributes:{ObjectID:b.__OBJECTID,Name:b.Name,RouteName:null,Sequence:b.Sequence,TimeWindowStart:b.TimeWindowStart,TimeWindowEnd:b.TimeWindowEnd,ArriveCurbApproach:b.ArrivalCurbApproach,DepartCurbApproach:b.DepartureCurbApproach,
CurbApproach:b.CurbApproach,Status:b.Status,ArriveTime:this.toGeolocalTime(b.ArrivalTime,b.ArrivalUTCOffset),DepartTime:this.toGeolocalTime(b.DepartureTime,b.DepartureUTCOffset),ArriveTimeUTC:b.ArrivalTime,DepartTimeUTC:b.DepartureTime,isWaypoint:1===b.LocationType}},f=d.attributes;f["Attr_"+C]=this.fromMinutes(b.ServiceMinutes,B);f["Attr_"+p]=this.fromMeters(b.ServiceMeters,u);m.mixin(f,h(w.parse(b.ServiceCosts||"{}"),"Attr_"));f["Cumul_"+C]=this.fromMinutes(b.CumulativeMinutes,B);f["Cumul_"+p]=
this.fromMeters(b.CumulativeMeters,u);m.mixin(f,h(w.parse(b.CumulativeCosts||"{}"),"Cumul_"));a.push(d)}return a})(),routeName:c.RouteName,spatialReference:A}:void 0,N=!1,f=K?m.mixin({returnStops:!0,returnDirections:!0,returnRoutes:!1,ignoreInvalidLocations:!0,outputLines:"esriNAOutputLineTrueShape",directionsOutputType:"complete",directionsLengthUnits:y,doNotLocateOnRestrictedElements:!0,outSpatialReference:new E(A),startTime:c?new Date(c.StartTime):null,startTimeIsUTC:!0,timeWindowsAreUTC:!0,stops:new L(function(){for(var a=
[],c=0;c<t.length;c++){var d=t[c].attributes,f={geometry:t[c].geometry,attributes:{CurbApproach:d.CurbApproach,Name:d.Name,Sequence:d.Sequence,isWaypoint:1===d.LocationType,TimeWindowStart:d.TimeWindowStart,TimeWindowEnd:d.TimeWindowEnd}};f.attributes["Attr_"+C]=b(d.ServiceMinutes,B);f.attributes["Attr_"+p]=g(d.ServiceMeters,u);m.mixin(f.attributes,h(w.parse(d.ServiceCosts||"{}"),"Attr_"));a.push(f);N=N||0<d.TimeWindowStart}return{spatialReference:A,geometryType:"esriGeometryPoint",features:a}}()),
barriers:new L(function(){for(var a=[],c=0;c<x.length;c++){var b=x[c].attributes,d={geometry:x[c].geometry,attributes:{CurbApproach:b.CurbApproach,Name:b.Name,FullEdge:b.FullEdge,BarrierType:b.BarrierType}};m.mixin(d.attributes,h(w.parse(b.Costs||b.OtherCosts||"{}"),"Attr_"));a.push(d)}return{spatialReference:A,geometryType:"esriGeometryPoint",features:a}}()),polylineBarriers:new L(function(){for(var a=[],c=0;c<v.length;c++){var b=v[c].attributes,d={geometry:v[c].geometry,attributes:{Name:b.Name,
ScaleFactor:b.ScaleFactor,BarrierType:b.BarrierType}};m.mixin(d.attributes,h(w.parse(b.Costs||b.OtherCosts||"{}"),"Attr_"));a.push(d)}return{spatialReference:A,geometryType:"esriGeometryPolyline",features:a}}()),polygonBarriers:new L(function(){for(var a=[],c=0;c<r.length;c++){var b=r[c].attributes,d={geometry:r[c].geometry,attributes:{Name:b.Name,ScaleFactor:b.ScaleFactor,BarrierType:b.BarrierType}};m.mixin(d.attributes,h(w.parse(b.Costs||b.OtherCosts||"{}"),"Attr_"));a.push(d)}return{spatialReference:A,
geometryType:"esriGeometryPolygon",features:a}}())},f):void 0;m.mixin(f||{},{useTimeWindows:N});B&&u||D.push({message:n.networkAnalysis.sharing.costAttributeMissing,messageType:"Warning"});e.resolve({routeParameters:m.mixin(new V,f),solveResult:{barriers:f&&f.barriers&&f.barriers.features||[],polygonBarriers:f&&f.polygonBarriers&&f.polygonBarriers.features||[],polylineBarriers:f&&f.polylineBarriers&&f.polylineBarriers.features||[],messages:w.parse(I||"[]"),routeResults:H?[new W(H)]:void 0},loadMessages:D,
isItemOwner:d.username===k.owner,title:k.title,ownerFolder:k.ownerFolder})}),e.reject)}),e.reject)}),e.reject)}),e.reject):e.reject(Error("No URL to a Portal instance or ArcGIS Online was specified at construction time."));return e.promise},store:function(c,a,e){var g=new v;c?e||c.directions?"1.0.0"!==e||c.directionPoints&&c.directionLines?c.stops&&c.stops.length?c.extent?c.routeInfo?c.folder?c.name?this.portal?this.portal.signIn().then(m.hitch(this,function(){var b=this._getRouteId();this._addOrUpdateItem(this._populateLayerInfo(b,
c,e),c,b,a,e).then(g.resolve,g.reject)}),g.reject):g.reject(Error("No URL to a Portal instance or ArcGIS Online was specified at construction time.")):g.reject(Error("Layer name is required.")):g.reject(Error("Folder Url is required.")):g.reject(Error("RouteInfo is required.")):g.reject(Error("Extent is required.")):g.reject(Error("Stops are required.")):g.reject(Error("DirectionPoints and DirectionLines are required.")):g.reject(Error("Directions are required.")):g.reject(Error("Missing required parameters."));
return g.promise},createFeatureCollection:function(c){var a=new v;if(c)if(c.directions&&c.directions&&c.directions.length)if(c.stops&&c.stops.length)if(c.extent)if(c.routeInfo)if(c.name){var e=this._getRouteId();a.resolve({title:c.name,layerInfo:this._populateLayerInfo(e,c)})}else a.reject(Error("Layer name is required."));else a.reject(Error("RouteInfo are required."));else a.reject(Error("Extent is required."));else a.reject(Error("Stops are required."));else a.reject(Error("Directions are required."));
else a.reject(Error("Missing required parameters."));return a.promise},_addOrUpdateItem:function(c,a,e,g,b){return m.hitch(this,function(){var c=new v;a.extent?this.project([{geometry:a.extent}],a.extent.spatialReference,new E(4326)).then(m.hitch(this,function(a){var b;a&&a[0]&&(a=a[0].geometry,b=a.xmin+","+a.ymin+","+a.xmax+","+a.ymax);c.resolve(b)}),c.resolve):c.resolve();return c.promise})().then(m.hitch(this,function(e){return I({url:g?a.folder+"/items/"+g+"/update":a.folder+"/addItem",content:{text:w.stringify(c),
extent:e,title:a.name,type:"Feature Collection",typeKeywords:"Data, Feature Collection, Multilayer, Route Layer",description:n.networkAnalysis.sharing.itemSnippet+" "+a.name+m.hitch(this,function(){var a=function(a){for(var b=0;b<c.layers.length;b++)if(c.layers[b].layerDefinition.name===a)return c.layers[b].featureSet.features;return[]},f=b?a("DirectionPoints"):a("Directions"),e=a("Stops"),g=a("RouteInfo")[0].attributes,h="english"===this.portal.getPortalUser().units?"esriMiles":"esriMeters",C=function(a){return T.format(a,
{places:2,locale:"root"})},J=m.hitch(this,function(a){return C(this.fromMeters(a,h))+" "+("esriMiles"===h?n.networkAnalysis.sharing.Miles:n.networkAnalysis.sharing.Meters)}),a=m.hitch(this,function(a){for(var c="\x3col\x3e",d=0;d<f.length;d++){var g;a:{g=f[d].attributes.StopSequence;if(void 0!==g)for(var h=0;h<e.length;h++)if(e[h].attributes.Sequence===g){g=e[h].attributes;break a}g={}}h=b?this._itemToManeuverType(this._itemCodeToItemString(f[d].attributes.DirectionPointType)):f[d].attributes.ManeuverType;
if(a||!d&&"esriDMTDepart"===h||d&&"esriDMTStop"===h)c+='\x3cli\x3e\x3cimg style\x3d"display:inline-block;margin:-3px 15px;" src\x3d"js/jsapi/esri/dijit/images/Directions/maneuvers/'+(null===g.ArrivalCurbApproach&&null!==g.DepartureCurbApproach?"esriDMTStopOrigin":null!==g.ArrivalCurbApproach&&null===g.DepartureCurbApproach?"esriDMTStopDestination":h)+'.png"\x3e\x3cspan\x3e'+(f[d].attributes.DirectionText||f[d].attributes.DisplayText)+"\x3c/span\x3e\x3cbr\x3e",a&&!b&&(c+="\x3cspan\x3e"+C(f[d].attributes.Minutes)+
" "+n.networkAnalysis.sharing.Minutes+"\x26nbsp;\x26middot;\x26nbsp;"+J(f[d].attributes.Meters)+"\x3c/span\x3e"),c+="\x3c/li\x3e"}return c+"\x3c/ol\x3e"}),g="\x3cbr\x3e\x3cbr\x3e\x3cb\x3e"+n.networkAnalysis.sharing.routeInfoLayer+"\x3c/b\x3e\x3cul\x3e\x3cli\x3e"+C(g.TotalMinutes)+" "+n.networkAnalysis.sharing.Minutes+"\x3c/li\x3e\x3cli\x3e"+J(g.TotalMeters)+"\x3c/li\x3e"+(void 0!==g.StartTime?"\x3cli\x3e"+n.networkAnalysis.sharing.StartTime+" "+(new Date(g.StartTime)).toString()+"\x3c/li\x3e":"")+
"\x3c/ul\x3e\x3cb\x3e"+n.networkAnalysis.sharing.directionsLayer+"\x3c/b\x3e",p=a(!0);65536<=(g+p).length&&(p=a(!1));return g+p})(),tags:n.networkAnalysis.sharing.itemTags+(a.name?", "+a.name:""),snippet:n.networkAnalysis.sharing.itemSnippet+" "+a.name,thumbnailUrl:a.thumbnail,licenseInfo:n.widgets.directions.printDisclaimer,f:"json"},callbackParamName:"callback"},{usePost:!0})}))},_getRouteId:function(){for(var c="",a=0;32>a;a++)c+="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"[Math.floor(62*
Math.random())];return c},_populateLayerInfo:function(c,a,e){var g={visibility:!0,layers:[],visibleLayers:[0,1,(a.barriers||[]).length?2:0,(a.barriers||[]).length?4:3,4,5,6],opacity:1};void 0===e?(this._addRouteInfoToLayerInfo(g,c,a.routeInfo,a.extent),this._addDirectionsToLayerInfo(g,c,a.directions,a.extent),this._addDirectionEventsToLayerInfo(g,c,a.directionEvents||[],a.extent),this._addBarriersToLayerInfo(g,c,a.barriers||[],a.extent),this._addPolylineBarriersToLayerInfo(g,c,a.polylineBarriers||
[],a.extent),this._addPolygonBarriersToLayerInfo(g,c,a.polygonBarriers||[],a.extent),this._addStopsToLayerInfo(g,c,a.stops,a.extent)):"1.0.0"===e&&((a.polygonBarriers||[]).length&&this._addPolygonBarriersToLayerInfo(g,c,a.polygonBarriers||[],a.extent),(a.polylineBarriers||[]).length&&this._addPolylineBarriersToLayerInfo(g,c,a.polylineBarriers||[],a.extent),this._addRouteInfoToLayerInfo_100(g,c,a.routeInfo,a.extent,e),this._addDirectionLinesToLayerInfo_100(g,c,a.directionLines||[],a.extent),(a.barriers||
[]).length&&this._addBarriersToLayerInfo(g,c,a.barriers||[],a.extent),this._addDirectionPointsToLayerInfo_100(g,c,a.directionPoints,a.extent),this._addStopsToLayerInfo_100(g,c,a.stops,a.extent));return g},_addStopsToLayerInfo:function(c,a,e,g){a=n.networkAnalysis;var b={type:"codedValue",name:"esriNACurbApproachType",codedValues:[{name:a.enums.esriNACurbApproachType.esriNAEitherSideOfVehicle,code:0},{name:a.enums.esriNACurbApproachType.esriNARightSideOfVehicle,code:1},{name:a.enums.esriNACurbApproachType.esriNALeftSideOfVehicle,
code:2},{name:a.enums.esriNACurbApproachType.esriNANoUTurn,code:3}]},h=this._generateFeatureCollectionTemplate("Stops",a.sharing.stopsLayer,"esriGeometryPoint"),d=h.layerDefinition.fields,f=0<e[0].attributes.ArrivalTime;d.push(this._createField("CurbApproach",a.fields.stops.CurbApproach,"integer",!1,b));d.push(this._createField("ArrivalCurbApproach",a.fields.stops.ArrivalCurbApproach,"integer",!0,b));d.push(this._createField("DepartureCurbApproach",a.fields.stops.DepartureCurbApproach,"integer",!0,
b));d.push(this._createField("Name",a.fields.stops.Name,"string",!0));d.push(this._createField("Sequence",a.fields.stops.Sequence,"integer",!0));d.push(this._createField("Status",a.fields.stops.Status,"integer",!0,{type:"codedValue",name:"esriNAObjectStatus",codedValues:[{name:a.enums.esriNAObjectStatus.esriNAObjectStatusOK,code:0},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusNotLocated,code:1},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusElementNotLocated,code:2},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusElementNotTraversable,
code:3},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusInvalidFieldValues,code:4},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusNotReached,code:5},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusTimeWindowViolation,code:6}]}));d.push(this._createField("LocationType",a.fields.stops.LocationType,"integer",!0,{type:"codedValue",name:"esriNALocationType",codedValues:[{name:a.enums.esriNALocationType.stop,code:0},{name:a.enums.esriNALocationType.waypoint,code:1}]}));d.push(this._createField("TimeWindowStart",
a.fields.stops.TimeWindowStart,"date",!1));d.push(this._createField("TimeWindowEnd",a.fields.stops.TimeWindowEnd,"date",!1));d.push(this._createField("ServiceMinutes",a.fields.stops.ServiceMinutes,"double",!1));d.push(this._createField("ServiceMeters",a.fields.stops.ServiceMeters,"double",!1));d.push(this._createField("ServiceCosts",a.fields.stops.ServiceCosts,"string",!1,null,this._jsonStringFieldSize));d.push(this._createField("CumulativeMinutes",a.fields.stops.CumulativeMinutes,"double",!0));d.push(this._createField("CumulativeMeters",
a.fields.stops.CumulativeMeters,"double",!0));d.push(this._createField("CumulativeCosts",a.fields.stops.CumulativeCosts,"string",!1,null,this._jsonStringFieldSize));d.push(this._createField("LateMinutes",a.fields.stops.LateMinutes,"double",!1));d.push(this._createField("WaitMinutes",a.fields.stops.WaitMinutes,"double",!1));d.push(this._createField("ArrivalTime",a.fields.stops.ArrivalTime,"date",f));d.push(this._createField("DepartureTime",a.fields.stops.DepartureTime,"date",f));d.push(this._createField("ArrivalUTCOffset",
a.fields.stops.ArrivalUTCOffset,"integer",f));d.push(this._createField("DepartureUTCOffset",a.fields.stops.DepartureUTCOffset,"integer",f));for(b=d=0;b<e.length;b++){var k=e[b],l=k.geometry;h.featureSet.features.push({geometry:l.toJson?l.toJson():l,attributes:m.mixin(k.attributes,{__OBJECTID:d++})})}h.layerDefinition.extent=g.toJson?g.toJson():g;g=new u(2>=e.length?new r(this.firstStopSymbol):new r(this.interimStopSymbol),"Sequence");for(b=0;b<e.length;b++)d=e[b].attributes,k=null,l=a.enums.esriNALocationType.stop,
1===d.LocationType?(k=new y(this.waypointSymbol),l=a.enums.esriNALocationType.waypoint):null===d.ArrivalCurbApproach&&null===d.DepartureCurbApproach?(k=new r(this.unlocatedStopSymbol),l=a.enums.esriNALocationType.stop+" : "+a.enums.esriNAObjectStatus.esriNAObjectStatusNotReached):null===d.ArrivalCurbApproach&&null!==d.DepartureCurbApproach?k=new r(this.firstStopSymbol):null!==d.ArrivalCurbApproach&&null===d.DepartureCurbApproach&&(k=new r(this.lastStopSymbol)),k&&g.addValue({value:d.Sequence,symbol:k,
label:l});h.layerDefinition.drawingInfo.renderer=g.toJson();h.popupInfo={title:"{Name}",fieldInfos:[{fieldName:"Name",label:a.fields.stops.Name,isEditable:!0,tooltip:"",visible:!0,stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"Sequence",label:a.fields.stops.Sequence,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"ArrivalTime",label:a.fields.stops.ArrivalTime,isEditable:!0,tooltip:"",visible:f,format:{dateFormat:"shortDateShortTime24"},
stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"ArrivalUTCOffset",label:a.fields.stops.ArrivalUTCOffset,isEditable:!1,tooltip:"",visible:f,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"DepartureTime",label:a.fields.stops.DepartureTime,isEditable:!0,tooltip:"",visible:f,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"DepartureUTCOffset",label:a.fields.stops.DepartureUTCOffset,
isEditable:!1,tooltip:"",visible:f,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"CurbApproach",label:a.fields.stops.CurbApproach,isEditable:!0,tooltip:"",visible:!1,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"ArrivalCurbApproach",label:a.fields.stops.ArrivalCurbApproach,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"DepartureCurbApproach",
label:a.fields.stops.DepartureCurbApproach,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"Status",label:a.fields.stops.Status,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"LocationType",label:a.fields.stops.LocationType,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},
{fieldName:"TimeWindowStart",label:a.fields.stops.TimeWindowStart,isEditable:!0,tooltip:"",visible:!1,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"TimeWindowEnd",label:a.fields.stops.TimeWindowEnd,isEditable:!0,tooltip:"",visible:!1,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"ServiceMinutes",label:a.fields.stops.ServiceMinutes,isEditable:!0,tooltip:"",visible:!1,format:{places:2,
digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"ServiceMeters",label:a.fields.stops.ServiceMeters,isEditable:!0,tooltip:"",visible:!1,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"ServiceCosts",label:a.fields.stops.ServiceCosts,isEditable:!0,tooltip:"",visible:!1,stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"CumulativeMinutes",label:a.fields.stops.CumulativeMinutes,isEditable:!1,tooltip:"",visible:!0,
format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"CumulativeMeters",label:a.fields.stops.CumulativeMeters,isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"CumulativeCosts",label:a.fields.stops.CumulativeCosts,isEditable:!0,tooltip:"",visible:!1,stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"LateMinutes",label:a.fields.stops.LateMinutes,isEditable:!1,tooltip:"",
visible:!1,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"WaitMinutes",label:a.fields.stops.WaitMinutes,isEditable:!1,tooltip:"",visible:!1,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1}],description:null,showAttachments:!1,mediaInfos:[]};c.layers.push(h)},_addDirectionsToLayerInfo:function(c,a,e,g){a=n.networkAnalysis;var b=a.enums.esriDirectionsManeuverType,h=this._generateFeatureCollectionTemplate("Directions",
a.sharing.directionsLayer,"esriGeometryPolyline"),d=h.layerDefinition.fields,f=e[0]&&e[0].attributes&&0<e[0].attributes.ArrivalTime;d.push(this._createField("Sequence",a.fields.directions.Sequence,"integer"));d.push(this._createField("StopSequence",a.fields.directions.StopSequence,"integer"));d.push(this._createField("ArrivalTime",a.fields.directions.ArrivalTime,"date",f));d.push(this._createField("UTCOffset",a.fields.directions.UTCOffset,"integer",f));d.push(this._createField("ManeuverType",a.fields.directions.ManeuverType,
"string",!0,{type:"codedValue",name:"esriDirectionsManeuverType",codedValues:[{name:b.esriDMTBearLeft,code:"esriDMTBearLeft"},{name:b.esriDMTBearRight,code:"esriDMTBearRight"},{name:b.esriDMTDepart,code:"esriDMTDepart"},{name:b.esriDMTDoorPassage,code:"esriDMTDoorPassage"},{name:b.esriDMTElevator,code:"esriDMTElevator"},{name:b.esriDMTEndOfFerry,code:"esriDMTEndOfFerry"},{name:b.esriDMTEscalator,code:"esriDMTEscalator"},{name:b.esriDMTFerry,code:"esriDMTFerry"},{name:b.esriDMTForkCenter,code:"esriDMTForkCenter"},
{name:b.esriDMTForkLeft,code:"esriDMTForkLeft"},{name:b.esriDMTForkRight,code:"esriDMTForkRight"},{name:b.esriDMTHighwayChange,code:"esriDMTHighwayChange"},{name:b.esriDMTHighwayExit,code:"esriDMTHighwayExit"},{name:b.esriDMTHighwayMerge,code:"esriDMTHighwayMerge"},{name:b.esriDMTPedestrianRamp,code:"esriDMTPedestrianRamp"},{name:b.esriDMTRampLeft,code:"esriDMTRampLeft"},{name:b.esriDMTRampRight,code:"esriDMTRampRight"},{name:b.esriDMTRoundabout,code:"esriDMTRoundabout"},{name:b.esriDMTSharpLeft,
code:"esriDMTSharpLeft"},{name:b.esriDMTSharpRight,code:"esriDMTSharpRight"},{name:b.esriDMTStairs,code:"esriDMTStairs"},{name:b.esriDMTStop,code:"esriDMTStop"},{name:b.esriDMTStraight,code:"esriDMTStraight"},{name:b.esriDMTTripItem,code:"esriDMTTripItem"},{name:b.esriDMTTurnLeft,code:"esriDMTTurnLeft"},{name:b.esriDMTTurnLeftLeft,code:"esriDMTTurnLeftLeft"},{name:b.esriDMTTurnLeftRight,code:"esriDMTTurnLeftRight"},{name:b.esriDMTTurnRight,code:"esriDMTTurnRight"},{name:b.esriDMTTurnRightLeft,code:"esriDMTTurnRightLeft"},
{name:b.esriDMTTurnRightRight,code:"esriDMTTurnRightRight"},{name:b.esriDMTUnknown,code:"esriDMTUnknown"},{name:b.esriDMTUTurn,code:"esriDMTUTurn"}]}));d.push(this._createField("Meters",a.fields.directions.Meters,"double",!0));d.push(this._createField("Minutes",a.fields.directions.Minutes,"double",!0));d.push(this._createField("DirectionText",a.fields.directions.DirectionText,"string",!0,null,2048));d.push(this._createField("ManeuverMessages",a.fields.directions.ManeuverMessages,"string",!1,null,
this._jsonStringFieldSize));for(d=b=0;d<e.length;d++){var k=e[d],l=k.geometry;h.featureSet.features.push({geometry:l&&l.toJson?l.toJson():l,attributes:m.mixin(k.attributes,{__OBJECTID:b++})})}h.layerDefinition.extent=g.toJson?g.toJson():g;e=new x(new D(this.directionSymbol));h.layerDefinition.drawingInfo.renderer=e.toJson();h.popupInfo={title:"{Text}",fieldInfos:[{fieldName:"ManeuverType",label:a.fields.directions.ManeuverType,isEditable:!1,tooltip:"",visible:!0,stringFieldOption:"textbox",isEditableOnLayer:!1},
{fieldName:"DirectionText",label:a.fields.directions.DirectionText,isEditable:!1,tooltip:"",visible:!0,stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"Sequence",label:a.fields.directions.Sequence,isEditable:!1,tooltip:"",visible:!1,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"StopSequence",label:a.fields.directions.StopSequence,isEditable:!1,tooltip:"",visible:!1,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},
{fieldName:"ArrivalTime",label:a.fields.directions.ArrivalTime,isEditable:!0,tooltip:"",visible:f,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"UTCOffset",label:a.fields.directions.UTCOffset,isEditable:!1,tooltip:"",visible:f,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"Meters",label:a.fields.directions.Meters,isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",
isEditableOnLayer:!1},{fieldName:"Minutes",label:a.fields.directions.Minutes,isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"ManeuverMessages",label:a.fields.directions.ManeuverMessages,isEditable:!1,tooltip:"",visible:!1,stringFieldOption:"textbox",isEditableOnLayer:!1}],description:null,showAttachments:!1,mediaInfos:[]};c.layers.push(h)},_addDirectionEventsToLayerInfo:function(c,a,e,g){a=n.networkAnalysis;var b=
this._generateFeatureCollectionTemplate("DirectionEvents",a.sharing.directionEventsLayer,"esriGeometryPoint"),h=b.layerDefinition.fields,d=e[0]&&e[0].attributes&&0<e[0].attributes.ArrivalTime;h.push(this._createField("ArrivalTime",a.fields.directionEvents.ArrivalTime,"date",d));h.push(this._createField("UTCOffset",a.fields.directionEvents.UTCOffset,"integer",d));h.push(this._createField("DirectionSequence",a.fields.directionEvents.DirectionSequence,"integer"));h.push(this._createField("Sequence",
a.fields.directionEvents.Sequence,"integer"));h.push(this._createField("EventText",a.fields.directionEvents.EventText,"string",!0,null,2048));h.push(this._createField("EventMessages",a.fields.directionEvents.EventMessages,"string",!1,null,this._jsonStringFieldSize));for(var f=h=0;f<e.length;f++){var k=e[f],l=k.geometry;b.featureSet.features.push({geometry:l&&l.toJson?l.toJson():l,attributes:m.mixin(k.attributes,{__OBJECTID:h++})})}b.layerDefinition.extent=g.toJson?g.toJson():g;e=new x(new y(this.directionEventSymbol));
b.layerDefinition.drawingInfo.renderer=e.toJson();b.popupInfo={title:a.sharing.directionEventsLayer,fieldInfos:[{fieldName:"EventText",label:a.fields.directionEvents.EventText,isEditable:!1,tooltip:"",visible:!0,stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"ArrivalTime",label:a.fields.directionEvents.ArrivalTime,isEditable:!0,tooltip:"",visible:d,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"UTCOffset",label:a.fields.directionEvents.UTCOffset,
isEditable:!1,tooltip:"",visible:d,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"DirectionSequence",label:a.fields.directionEvents.DirectionSequence,isEditable:!1,tooltip:"",visible:!1,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"Sequence",label:a.fields.directionEvents.Sequence,isEditable:!1,tooltip:"",visible:!1,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},
{fieldName:"EventMessages",label:a.fields.directionEvents.EventMessages,isEditable:!1,tooltip:"",visible:!1,stringFieldOption:"textbox",isEditableOnLayer:!1}],description:null,showAttachments:!1,mediaInfos:[]};c.layers.push(b)},_addBarriersToLayerInfo:function(c,a,e,g){a=n.networkAnalysis;var b=this._generateFeatureCollectionTemplate("Barriers",a.sharing.barriersLayer,"esriGeometryPoint"),h=b.layerDefinition.fields;h.push(this._createField("Name",a.fields.barriers.Name,"string",!0));h.push(this._createField("BarrierType",
a.fields.barriers.BarrierType,"integer",!0,{type:"codedValue",name:"esriNABarrierType",codedValues:[{name:a.enums.esriNABarrierType.esriNABTRestriction,code:0},{name:a.enums.esriNABarrierType.esriNABTScaledCost,code:1},{name:a.enums.esriNABarrierType.esriNABTAddedCost,code:2}]}));h.push(this._createField("FullEdge",a.fields.barriers.FullEdge,"integer",!0,{type:"codedValue",name:"esriNAIntYesNo",codedValues:[{name:a.enums.esriNAIntYesNo.No,code:0},{name:a.enums.esriNAIntYesNo.Yes,code:1}]}));h.push(this._createField("AddedCost",
a.fields.barriers.AddedCost,"double",!0));h.push(this._createField("Costs",a.fields.barriers.Costs,"string",!1,null,this._jsonStringFieldSize));h.push(this._createField("Status",a.fields.barriers.Status,"integer",!0,{type:"codedValue",name:"esriNAObjectStatus",codedValues:[{name:a.enums.esriNAObjectStatus.esriNAObjectStatusOK,code:0},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusNotLocated,code:1},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusElementNotLocated,code:2},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusElementNotTraversable,
code:3},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusInvalidFieldValues,code:4},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusNotReached,code:5},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusTimeWindowViolation,code:6}]}));h.push(this._createField("CurbApproach",a.fields.barriers.CurbApproach,"integer",!1,{type:"codedValue",name:"esriNACurbApproachType",codedValues:[{name:a.enums.esriNACurbApproachType.esriNAEitherSideOfVehicle,code:0},{name:a.enums.esriNACurbApproachType.esriNARightSideOfVehicle,
code:1},{name:a.enums.esriNACurbApproachType.esriNALeftSideOfVehicle,code:2},{name:a.enums.esriNACurbApproachType.esriNANoUTurn,code:3}]}));for(var d=h=0;d<e.length;d++){var f=e[d],k=f.geometry,l=f.attributes;b.featureSet.features.push({geometry:k&&k.toJson?k.toJson():k,attributes:m.mixin(f.attributes,{__OBJECTID:++h,FullEdge:l.FullEdge||0,Status:l.Status||0,CurbApproach:l.CurbApproach||0})})}b.layerDefinition.extent=g.toJson?g.toJson():g;b.layerDefinition.drawingInfo.renderer=this.barrierRenderer.toJson();
b.popupInfo={title:a.sharing.barriersLayer,fieldInfos:[{fieldName:"Name",label:a.fields.barriers.Name,isEditable:!0,tooltip:"",visible:!0,stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"BarrierType",label:a.fields.barriers.BarrierType,isEditable:!0,tooltip:"",visible:!0,stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"CurbApproach",label:a.fields.barriers.CurbApproach,isEditable:!0,tooltip:"",visible:!0,stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"FullEdge",
label:a.fields.barriers.FullEdge,isEditable:!0,tooltip:"",visible:!1,stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"AddedCost",label:a.fields.barriers.AddedCost,isEditable:!0,tooltip:"",visible:!0,format:{places:3,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"Costs",label:a.fields.barriers.Costs,isEditable:!0,tooltip:"",visible:!1,stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"Status",label:a.fields.barriers.Status,isEditable:!1,tooltip:"",
visible:!1,stringFieldOption:"textbox",isEditableOnLayer:!1}],description:null,showAttachments:!1,mediaInfos:[]};c.layers.push(b)},_addPolylineBarriersToLayerInfo:function(c,a,e,g){a=n.networkAnalysis;var b=this._generateFeatureCollectionTemplate("PolylineBarriers",a.sharing.polylineBarriersLayer,"esriGeometryPolyline"),h=b.layerDefinition.fields;h.push(this._createField("Name",a.fields.polylineBarriers.Name,"string",!0));h.push(this._createField("BarrierType",a.fields.polylineBarriers.BarrierType,
"integer",!0,{type:"codedValue",name:"esriNABarrierType",codedValues:[{name:a.enums.esriNABarrierType.esriNABTRestriction,code:0},{name:a.enums.esriNABarrierType.esriNABTScaledCost,code:1},{name:a.enums.esriNABarrierType.esriNABTAddedCost,code:2}]}));h.push(this._createField("ScaleFactor",a.fields.polylineBarriers.ScaleFactor,"double",!0));h.push(this._createField("Costs",a.fields.polylineBarriers.Costs,"string",!1,null,this._jsonStringFieldSize));for(var d=h=0;d<e.length;d++){var f=e[d],k=f.geometry;
b.featureSet.features.push({geometry:k&&k.toJson?k.toJson():k,attributes:m.mixin(f.attributes,{__OBJECTID:++h})})}b.layerDefinition.extent=g.toJson?g.toJson():g;b.layerDefinition.drawingInfo.renderer=this.polylineBarrierRenderer.toJson();b.popupInfo={title:a.sharing.polylineBarriersLayer,fieldInfos:[{fieldName:"Name",label:a.fields.polylineBarriers.Name,isEditable:!0,tooltip:"",visible:!0,stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"BarrierType",label:a.fields.polylineBarriers.BarrierType,
isEditable:!0,tooltip:"",visible:!0,stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"ScaleFactor",label:a.fields.polylineBarriers.ScaleFactor,isEditable:!0,tooltip:"",visible:!0,format:{places:3,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"Costs",label:a.fields.polylineBarriers.Costs,isEditable:!0,tooltip:"",visible:!1,stringFieldOption:"textbox",isEditableOnLayer:!1}],description:null,showAttachments:!1,mediaInfos:[]};c.layers.push(b)},_addPolygonBarriersToLayerInfo:function(c,
a,e,g){a=n.networkAnalysis;var b=this._generateFeatureCollectionTemplate("PolygonBarriers",a.sharing.polygonBarriersLayer,"esriGeometryPolygon"),h=b.layerDefinition.fields;h.push(this._createField("Name",a.fields.polygonBarriers.Name,"string",!0));h.push(this._createField("BarrierType",a.fields.polygonBarriers.BarrierType,"integer",!0,{type:"codedValue",name:"esriNABarrierType",codedValues:[{name:a.enums.esriNABarrierType.esriNABTRestriction,code:0},{name:a.enums.esriNABarrierType.esriNABTScaledCost,
code:1},{name:a.enums.esriNABarrierType.esriNABTAddedCost,code:2}]}));h.push(this._createField("ScaleFactor",a.fields.polygonBarriers.ScaleFactor,"double",!0));h.push(this._createField("Costs",a.fields.polygonBarriers.Costs,"string",!1,null,this._jsonStringFieldSize));for(var d=h=0;d<e.length;d++){var f=e[d],k=f.geometry;b.featureSet.features.push({geometry:k&&k.toJson?k.toJson():k,attributes:m.mixin(f.attributes,{__OBJECTID:++h})})}b.layerDefinition.extent=g.toJson?g.toJson():g;b.layerDefinition.drawingInfo.renderer=
this.polygonBarrierRenderer.toJson();b.popupInfo={title:a.sharing.polygonBarriersLayer,fieldInfos:[{fieldName:"Name",label:a.fields.polygonBarriers.Name,isEditable:!0,tooltip:"",visible:!0,stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"BarrierType",label:a.fields.polygonBarriers.BarrierType,isEditable:!0,tooltip:"",visible:!0,stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"ScaleFactor",label:a.fields.polygonBarriers.ScaleFactor,isEditable:!0,tooltip:"",visible:!0,format:{places:3,
digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"Costs",label:a.fields.polygonBarriers.Costs,isEditable:!0,tooltip:"",visible:!1,stringFieldOption:"textbox",isEditableOnLayer:!1}],description:null,showAttachments:!1,mediaInfos:[]};c.layers.push(b)},_addRouteInfoToLayerInfo:function(c,a,e,g){a=n.networkAnalysis;var b=this._generateFeatureCollectionTemplate("RouteInfo",a.sharing.routeInfoLayer,"esriGeometryPolyline"),h=b.layerDefinition.fields,d=void 0!==e.attributes.StartTime&&
null!==e.attributes.StartTime;h.push(this._createField("RouteName",a.fields.routeInfo.RouteName,"string",!0,null,1024));h.push(this._createField("TotalMinutes",a.fields.routeInfo.TotalMinutes,"double",!0));h.push(this._createField("TotalMeters",a.fields.routeInfo.TotalMeters,"double",!0));h.push(this._createField("TotalLateMinutes",a.fields.routeInfo.TotalLateMinutes,"double"));h.push(this._createField("TotalWaitMinutes",a.fields.routeInfo.TotalWaitMinutes,"double"));h.push(this._createField("TotalCosts",
a.fields.routeInfo.TotalCosts,"string",!1,null,this._jsonStringFieldSize));h.push(this._createField("StartTime",a.fields.routeInfo.StartTime,"date",d));h.push(this._createField("StartUTCOffset",a.fields.routeInfo.StartUTCOffset,"integer",d));h.push(this._createField("EndTime",a.fields.routeInfo.EndTime,"date",d));h.push(this._createField("EndUTCOffset",a.fields.routeInfo.EndUTCOffset,"integer",d));h.push(this._createField("Messages",a.fields.routeInfo.Messages,"string",!1,null,this._jsonStringFieldSize));
h.push(this._createField("AnalysisSettings",a.fields.routeInfo.AnalysisSettings,"string",!1,null,this._jsonStringFieldSize));h=e.geometry;b.featureSet.features.push({geometry:h&&h.toJson?h.toJson():h,attributes:m.mixin(e.attributes,{__OBJECTID:1})});b.layerDefinition.extent=g.toJson?g.toJson():g;e=new x(new D(this.routeSymbol));b.layerDefinition.drawingInfo.renderer=e.toJson();b.popupInfo={title:a.sharing.routeInfoLayer,fieldInfos:[{fieldName:"RouteName",label:a.fields.routeInfo.RouteName,isEditable:!1,
tooltip:"",visible:!0,stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"TotalMinutes",label:a.fields.routeInfo.TotalMinutes,isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"TotalMeters",label:a.fields.routeInfo.TotalMeters,isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"TotalLateMinutes",label:a.fields.routeInfo.TotalLateMinutes,
isEditable:!1,tooltip:"",visible:!1,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"TotalWaitMinutes",label:a.fields.routeInfo.TotalWaitMinutes,isEditable:!1,tooltip:"",visible:!1,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"TotalCosts",label:a.fields.routeInfo.TotalCosts,isEditable:!1,tooltip:"",visible:!1,stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"StartTime",label:a.fields.routeInfo.StartTime,
isEditable:!1,tooltip:"",visible:d,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"StartUTCOffset",label:a.fields.routeInfo.StartUTCOffset,isEditable:!1,tooltip:"",visible:d,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"EndTime",label:a.fields.routeInfo.EndTime,isEditable:!1,tooltip:"",visible:d,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"EndUTCOffset",
label:a.fields.routeInfo.EndUTCOffset,isEditable:!1,tooltip:"",visible:d,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"Messages",label:a.fields.routeInfo.Messages,isEditable:!1,tooltip:"",visible:!1,stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"SolverSettings",label:a.fields.routeInfo.SolverSettings,isEditable:!1,tooltip:"",visible:!1,stringFieldOption:"textbox",isEditableOnLayer:!1}],description:null,showAttachments:!1,mediaInfos:[]};
c.layers.push(b)},_loadDirectionsFeatureSet:function(c,a,e,g,b){for(var h=[],d=function(a){var d=a,f=c[d].geometry;a=function(a){for(;!f&&(0>a&&0<d||0<a&&d<c.length-1);){d+=a;var e=c[d].geometry;if(e&&e.paths&&e.paths[0]){f={paths:[[e.paths[0][0<a?0:e.paths[0].length-1],e.paths[0][0<a?0:e.paths[0].length-1]]],spatialReference:b};break}}return f};return a(1)||a(-1)},f=m.hitch(this,function(c){for(var b=[],d=0;d<a.length;d++)a[d].attributes.DirectionSequence===c&&(b.push({ETA:this.toGeolocalTime(a[d].attributes.ArrivalTime,
a[d].attributes.UTCOffset),arriveTimeUTC:null===a[d].attributes.UTCOffset?void 0:a[d].attributes.ArrivalTime,strings:w.parse(a[d].attributes.EventMessages)||[],point:{x:a[d].geometry.x,y:a[d].geometry.y}}),a[d].attributes.EventText&&b[b.length-1].strings.splice(0,0,{string:a[d].attributes.EventText,stringType:"esriDSTGeneral"}));return b}),k=0;k<c.length;k++){var l={attributes:{length:this.fromMeters(c[k].attributes.Meters,e),time:this.fromMinutes(c[k].attributes.Minutes,g),text:c[k].attributes.DirectionText,
ETA:this.toGeolocalTime(c[k].attributes.ArrivalTime,c[k].attributes.UTCOffset),arriveTimeUTC:null===c[k].attributes.UTCOffset?void 0:c[k].attributes.ArrivalTime,maneuverType:c[k].attributes.ManeuverType,_stopSequence:c[k].attributes.StopSequence},geometry:d(k)||ss[0]&&ss[0].geometry&&{paths:[[[ss[0].geometry.x,ss[0].geometry.y]]],spatialReference:b},strings:w.parse(c[k].attributes.ManeuverMessages||"[]"),events:f(k)};0===l.strings.length&&delete l.strings;h.push(l)}return h},_addStopsToLayerInfo_100:function(c,
a,e,g){a=n.networkAnalysis;var b={type:"codedValue",name:"esriNACurbApproachType",codedValues:[{name:a.enums.esriNACurbApproachType.esriNAEitherSideOfVehicle,code:0},{name:a.enums.esriNACurbApproachType.esriNARightSideOfVehicle,code:1},{name:a.enums.esriNACurbApproachType.esriNALeftSideOfVehicle,code:2},{name:a.enums.esriNACurbApproachType.esriNANoUTurn,code:3}]},h=this._generateFeatureCollectionTemplate("Stops",a.sharing.stopsLayer,"esriGeometryPoint"),d=h.layerDefinition.fields,f=0<e[0].attributes.ArrivalTime;
d.push(this._createField("CurbApproach",a.fields.stops.CurbApproach,"integer",!1,b));d.push(this._createField("ArrivalCurbApproach",a.fields.stops.ArrivalCurbApproach,"integer",!0,b));d.push(this._createField("DepartureCurbApproach",a.fields.stops.DepartureCurbApproach,"integer",!0,b));d.push(this._createField("Name",a.fields.stops.Name,"string",!0));d.push(this._createField("RouteName",a.fields.routeInfo.RouteName,"string",!0));d.push(this._createField("Sequence",a.fields.stops.Sequence,"integer",
!0));d.push(this._createField("Status",a.fields.stops.Status,"integer",!0,{type:"codedValue",name:"esriNAObjectStatus",codedValues:[{name:a.enums.esriNAObjectStatus.esriNAObjectStatusOK,code:0},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusNotLocated,code:1},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusElementNotLocated,code:2},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusElementNotTraversable,code:3},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusInvalidFieldValues,code:4},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusNotReached,
code:5},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusTimeWindowViolation,code:6}]}));d.push(this._createField("LocationType",a.fields.stops.LocationType,"integer",!0,{type:"codedValue",name:"esriNALocationType",codedValues:[{name:a.enums.esriNALocationType.stop,code:0},{name:a.enums.esriNALocationType.waypoint,code:1}]}));d.push(this._createField("TimeWindowStart",a.fields.stops.TimeWindowStart,"date",!1));d.push(this._createField("TimeWindowEnd",a.fields.stops.TimeWindowEnd,"date",!1));d.push(this._createField("TimeWindowStartUTCOffset",
a.fields.stops.TimeWindowStart+": "+a.fields.directions.UTCOffset,"integer",f));d.push(this._createField("TimeWindowEndUTCOffset",a.fields.stops.TimeWindowEnd+": "+a.fields.directions.UTCOffset,"integer",f));d.push(this._createField("ServiceMinutes",a.fields.stops.ServiceMinutes,"double",!1));d.push(this._createField("ServiceMeters",a.fields.stops.ServiceMeters,"double",!1));d.push(this._createField("ServiceCosts",a.fields.stops.ServiceCosts,"string",!1,null,this._jsonStringFieldSize));d.push(this._createField("CumulativeMinutes",
a.fields.stops.CumulativeMinutes,"double",!0));d.push(this._createField("CumulativeMeters",a.fields.stops.CumulativeMeters,"double",!0));d.push(this._createField("CumulativeCosts",a.fields.stops.CumulativeCosts,"string",!1,null,this._jsonStringFieldSize));d.push(this._createField("LateMinutes",a.fields.stops.LateMinutes,"double",!1));d.push(this._createField("WaitMinutes",a.fields.stops.WaitMinutes,"double",!1));d.push(this._createField("ArrivalTime",a.fields.stops.ArrivalTime,"date",f));d.push(this._createField("DepartureTime",
a.fields.stops.DepartureTime,"date",f));d.push(this._createField("ArrivalUTCOffset",a.fields.stops.ArrivalUTCOffset,"integer",f));d.push(this._createField("DepartureUTCOffset",a.fields.stops.DepartureUTCOffset,"integer",f));for(b=d=0;b<e.length;b++){var k=e[b],l=k.geometry;h.featureSet.features.push({geometry:l.toJson?l.toJson():l,attributes:void 0!==k.attributes.__OBJECTID?k.attributes:m.mixin(k.attributes,{__OBJECTID:++d})})}h.layerDefinition.extent=g.toJson?g.toJson():g;g=new u(2>=e.length?new r(this.firstStopSymbol):
new r(this.interimStopSymbol),"Sequence");for(b=0;b<e.length;b++)d=e[b].attributes,k=null,l=a.enums.esriNALocationType.stop,1===d.LocationType?(k=new y(this.waypointSymbol),l=a.enums.esriNALocationType.waypoint):null===d.ArrivalCurbApproach&&null===d.DepartureCurbApproach?(k=new r(this.unlocatedStopSymbol),l=a.enums.esriNALocationType.stop+" : "+a.enums.esriNAObjectStatus.esriNAObjectStatusNotReached):null===d.ArrivalCurbApproach&&null!==d.DepartureCurbApproach?k=new r(this.firstStopSymbol):null!==
d.ArrivalCurbApproach&&null===d.DepartureCurbApproach&&(k=new r(this.lastStopSymbol)),k&&g.addValue({value:d.Sequence,symbol:k,label:l});h.layerDefinition.drawingInfo.renderer=g.toJson();h.popupInfo={title:"{Name}",fieldInfos:[{fieldName:"Name",label:a.fields.stops.Name,isEditable:!0,tooltip:"",visible:!0,stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"RouteName",label:a.fields.routeInfo.RouteName,isEditable:!0,tooltip:"",visible:!0,stringFieldOption:"textbox",isEditableOnLayer:!0},
{fieldName:"Sequence",label:a.fields.stops.Sequence,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"ArrivalTime",label:a.fields.stops.ArrivalTime,isEditable:!0,tooltip:"",visible:f,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"ArrivalUTCOffset",label:a.fields.stops.ArrivalUTCOffset,isEditable:!1,tooltip:"",visible:f,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",
isEditableOnLayer:!1},{fieldName:"DepartureTime",label:a.fields.stops.DepartureTime,isEditable:!0,tooltip:"",visible:f,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"DepartureUTCOffset",label:a.fields.stops.DepartureUTCOffset,isEditable:!1,tooltip:"",visible:f,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"CurbApproach",label:a.fields.stops.CurbApproach,isEditable:!0,tooltip:"",visible:!1,
format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"ArrivalCurbApproach",label:a.fields.stops.ArrivalCurbApproach,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"DepartureCurbApproach",label:a.fields.stops.DepartureCurbApproach,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"Status",
label:a.fields.stops.Status,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"LocationType",label:a.fields.stops.LocationType,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"TimeWindowStart",label:a.fields.stops.TimeWindowStart,isEditable:!0,tooltip:"",visible:!1,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox",
isEditableOnLayer:!0},{fieldName:"TimeWindowStartUTCOffset",label:a.fields.stops.TimeWindowStart+": "+a.fields.directions.UTCOffset,isEditable:!1,tooltip:"",visible:!1,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"TimeWindowEnd",label:a.fields.stops.TimeWindowEnd,isEditable:!0,tooltip:"",visible:!1,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"TimeWindowEndUTCOffset",label:a.fields.stops.TimeWindowEnd+
": "+a.fields.directions.UTCOffset,isEditable:!1,tooltip:"",visible:!1,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"ServiceMinutes",label:a.fields.stops.ServiceMinutes,isEditable:!0,tooltip:"",visible:!1,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"ServiceMeters",label:a.fields.stops.ServiceMeters,isEditable:!0,tooltip:"",visible:!1,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",
isEditableOnLayer:!0},{fieldName:"ServiceCosts",label:a.fields.stops.ServiceCosts,isEditable:!0,tooltip:"",visible:!1,stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"CumulativeMinutes",label:a.fields.stops.CumulativeMinutes,isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"CumulativeMeters",label:a.fields.stops.CumulativeMeters,isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",
isEditableOnLayer:!1},{fieldName:"CumulativeCosts",label:a.fields.stops.CumulativeCosts,isEditable:!0,tooltip:"",visible:!1,stringFieldOption:"textbox",isEditableOnLayer:!0},{fieldName:"LateMinutes",label:a.fields.stops.LateMinutes,isEditable:!1,tooltip:"",visible:!1,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"WaitMinutes",label:a.fields.stops.WaitMinutes,isEditable:!1,tooltip:"",visible:!1,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",
isEditableOnLayer:!1}],description:null,showAttachments:!1,mediaInfos:[]};c.layers.push(h)},_addRouteInfoToLayerInfo_100:function(c,a,e,g,b){this._addRouteInfoToLayerInfo(c,a,e,g);a=n.networkAnalysis;c=c.layers[c.layers.length-1];c.layerDefinition.fields.push(this._createField("Version",a.fields.routeInfo.Version,"string",!0,null,16));c.popupInfo.fieldInfos.push({fieldName:"Version",label:a.fields.routeInfo.Version,isEditable:!1,tooltip:"",visible:!0,stringFieldOption:"textbox",isEditableOnLayer:!1});
c.featureSet.features[0].attributes.Version=b},_addDirectionPointsToLayerInfo_100:function(c,a,e,g){a=n.networkAnalysis;var b=a.enums.esriDirectionItemType,h=this._generateFeatureCollectionTemplate("DirectionPoints",a.sharing.directionPointsLayer,"esriGeometryPoint"),d=h.layerDefinition.fields,f=e[0]&&e[0].attributes&&0<e[0].attributes.ArrivalTime;d.push(this._createField("Sequence",a.fields.directions.Sequence,"integer",!0));d.push(this._createField("StopID",a.fields.directions.StopID,"integer",
!0));d.push(this._createField("DirectionPointType",a.fields.directions.ItemType,"integer",!0,{type:"codedValue",name:"esriDirectionPointType",codedValues:[{name:b.esriDITUnknown,code:0},{name:"",code:1},{name:b.esriDITManeuverArrive,code:50},{name:b.esriDITManeuverDepart,code:51},{name:b.esriDITManeuverStraight,code:52},{name:b.esriDITManeuverFerryOn,code:100},{name:b.esriDITManeuverFerryOff,code:101},{name:b.esriDITManeuverForkCenter,code:102},{name:b.esriDITManeuverRoundabout,code:103},{name:b.esriDITManeuverUTurn,
code:104},{name:b.esriDITManeuverDoor,code:150},{name:b.esriDITManeuverStairs,code:151},{name:b.esriDITManeuverElevator,code:152},{name:b.esriDITManeuverEscalator,code:153},{name:b.esriDITManeuverPedestrianRamp,code:154},{name:b.esriDITManeuverForkLeft,code:200},{name:b.esriDITManeuverRampLeft,code:201},{name:b.esriDITManeuverRoundaboutLeft,code:202},{name:b.esriDITManeuverUTurnLeft,code:203},{name:b.esriDITManeuverBearLeft,code:204},{name:b.esriDITManeuverTurnLeft,code:205},{name:b.esriDITManeuverSharpLeft,
code:206},{name:b.esriDITManeuverTurnLeftLeft,code:207},{name:b.esriDITManeuverTurnLeftRight,code:208},{name:b.esriDITManeuverForkRight,code:300},{name:b.esriDITManeuverRampRight,code:301},{name:b.esriDITManeuverRoundaboutRight,code:302},{name:b.esriDITManeuverUTurnRight,code:303},{name:b.esriDITManeuverBearRight,code:304},{name:b.esriDITManeuverTurnRight,code:305},{name:b.esriDITManeuverSharpRight,code:306},{name:b.esriDITManeuverTurnRightLeft,code:307},{name:b.esriDITManeuverTurnRightRight,code:308},
{name:b.esriDITManeuverElevatorUp,code:400},{name:b.esriDITManeuverEscalatorUp,code:401},{name:b.esriDITManeuverStairsUp,code:402},{name:b.esriDITManeuverElevatorDown,code:500},{name:b.esriDITManeuverEscalatorDown,code:501},{name:b.esriDITManeuverStairsDown,code:502},{name:b.esriDITEvent,code:1E3},{name:b.esriDITEventLandmark,code:1001},{name:b.esriDITEventTimeZone,code:1002},{name:b.esriDITEventTraffic,code:1003},{name:b.esriDITEventBarrier,code:1004},{name:b.esriDITEventBoundary,code:1005},{name:b.esriDITEventRestrictionViolation,
code:1006}]}));d.push(this._createField("DisplayText",a.fields.directions.DisplayText,"string",!0,null,2048));d.push(this._createField("ArrivalTime",a.fields.directions.ArrivalTime,"date",f));d.push(this._createField("ArrivalUTCOffset",a.fields.directions.UTCOffset,"integer",f));d.push(this._createField("Azimuth",a.fields.directions.Azimuth,"double",!0));d.push(this._createField("Name",a.fields.directions.Name,"string",!0,null,2048));d.push(this._createField("AlternateName",a.fields.directions.AlternativeName,
"string",!0,null,2048));d.push(this._createField("ExitName",a.fields.directions.ExitName,"string",!0,null,2048));d.push(this._createField("IntersectingName",a.fields.directions.IntersectingName,"string",!0,null,2048));d.push(this._createField("BranchName",a.fields.directions.BranchName,"string",!0,null,2048));d.push(this._createField("TowardName",a.fields.directions.TowardName,"string",!0,null,2048));d.push(this._createField("ShortVoiceInstruction",a.fields.directions.VoiceShortText,"string",!0,null,
2048));d.push(this._createField("VoiceInstruction",a.fields.directions.VoiceFullText,"string",!0,null,2048));d.push(this._createField("Level",a.fields.directions.Level,"integer",!0));for(d=b=0;d<e.length;d++){var k=e[d],l=k.geometry,k=k.attributes;k.DirectionPointType=this._itemStringToItemCode(k.DirectionPointType);h.featureSet.features.push({geometry:l&&l.toJson?l.toJson():l,attributes:void 0!==k.__OBJECTID?k:m.mixin(k,{__OBJECTID:++b})})}h.layerDefinition.extent=g.toJson?g.toJson():g;e=new x(new y(this.directionPointSymbol));
h.layerDefinition.drawingInfo.renderer=e.toJson();h.popupInfo={title:"{DisplayText}",fieldInfos:[{fieldName:"DirectionPointType",label:a.fields.directions.ItemType,isEditable:!1,tooltip:"",visible:!0,stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"DisplayText",label:a.fields.directions.DisplayText,isEditable:!1,tooltip:"",visible:!0,stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"Sequence",label:a.fields.directions.Sequence,isEditable:!1,tooltip:"",visible:!0,format:{places:0,
digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"StopID",label:a.fields.directions.StopID,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"ArrivalTime",label:a.fields.directions.ArrivalTime,isEditable:!0,tooltip:"",visible:f,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"ArrivalUTCOffset",label:a.fields.directions.UTCOffset,
isEditable:!1,tooltip:"",visible:f,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"Azimuth",label:a.fields.directions.Azimuth,isEditable:!1,tooltip:"",visible:!1,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"Name",label:a.fields.directions.Name,isEditable:!1,tooltip:"",visible:!0,stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"AlternateName",label:a.fields.directions.AlternativeName,
isEditable:!1,tooltip:"",visible:!0,stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"ExitName",label:a.fields.directions.ExitName,isEditable:!1,tooltip:"",visible:!0,stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"IntersectingName",label:a.fields.directions.IntersectingName,isEditable:!1,tooltip:"",visible:!0,stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"BranchName",label:a.fields.directions.BranchName,isEditable:!1,tooltip:"",visible:!0,stringFieldOption:"textbox",
isEditableOnLayer:!1},{fieldName:"TowardName",label:a.fields.directions.TowardName,isEditable:!1,tooltip:"",visible:!0,stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"ShortVoiceInstruction",label:a.fields.directions.VoiceShortText,isEditable:!1,tooltip:"",visible:!1,stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"VoiceInstruction",label:a.fields.directions.VoiceFullText,isEditable:!1,tooltip:"",visible:!1,stringFieldOption:"textbox",isEditableOnLayer:!1}],description:null,
showAttachments:!1,mediaInfos:[]};c.layers.push(h)},_addDirectionLinesToLayerInfo_100:function(c,a,e,g){a=n.networkAnalysis;var b=a.enums.esriDirectionsLineType,h=this._generateFeatureCollectionTemplate("DirectionLines",a.sharing.directionLinesLayer,"esriGeometryPolyline"),d=h.layerDefinition.fields;d.push(this._createField("DirectionPointID",a.fields.directionLines.DirectionPointID,"integer"));d.push(this._createField("DirectionLineType",a.fields.directionLines.LineType,"integer",!0,{type:"codedValue",
name:"esriDirectionsLineType",codedValues:[{name:b.esriDLTUnknown,code:0},{name:b.esriDLTSegment,code:1},{name:b.esriDLTSegmentManeuver,code:2},{name:b.esriDLTSoftRestrictionViolation,code:3},{name:b.esriDLTBarrier,code:4},{name:b.esriDLTStopAndGoTraffic,code:5},{name:b.esriDLTSlowTraffic,code:6},{name:b.esriDLTModerateTraffic,code:7}]}));d.push(this._createField("Meters",a.fields.directionLines.Meters,"double",!0));d.push(this._createField("Minutes",a.fields.directionLines.Minutes,"double",!0));
d.push(this._createField("FromLevel",a.fields.directionLines.LevelFrom,"integer"));d.push(this._createField("ToLevel",a.fields.directionLines.LevelTo,"integer"));for(d=b=0;d<e.length;d++){var f=e[d],k=f.geometry,f=f.attributes;f.DirectionLineType=this._lineTypeStringToLineTypeCode(f.DirectionLineType);h.featureSet.features.push({geometry:k&&k.toJson?k.toJson():k,attributes:void 0!==f.__OBJECTID?f:m.mixin(f,{__OBJECTID:++b})})}h.layerDefinition.extent=g.toJson?g.toJson():g;e=new x(new D(this.directionLineSymbol));
h.layerDefinition.drawingInfo.renderer=e.toJson();h.popupInfo={title:a.sharing.directionLinesLayer,fieldInfos:[{fieldName:"DirectionLineType",label:a.fields.directionLines.LineType,isEditable:!1,tooltip:"",visible:!0,stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"Meters",label:a.fields.directionLines.Meters,isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"Minutes",label:a.fields.directionLines.Minutes,
isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"DirectionPointID",label:a.fields.directionLines.DirectionPointID,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},{fieldName:"FromLevel",label:a.fields.directionLines.LevelFrom,isEditable:!1,tooltip:"",visible:!1,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1},
{fieldName:"ToLevel",label:a.fields.directionLines.LevelTo,isEditable:!1,tooltip:"",visible:!1,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox",isEditableOnLayer:!1}],description:null,showAttachments:!1,mediaInfos:[]};c.layers.push(h)},_loadDirectionsFeatureSet_100:function(c,a,e,g,b,h){var d=[],f,k=function(c){for(var b=0;b<a.length;b++)if(a[b].attributes.DirectionSequence==c)return a[b];return null},l=m.hitch(this,function(a){for(var b=[];a<c.length&&0===c[a].attributes.DirectionPointType.indexOf("esriDPTEvent");)b.push({ETA:this.toGeolocalTime(c[a].attributes.ArrivalTime,
c[a].attributes.ArrivalUTCOffset),arriveTimeUTC:null===c[a].attributes.ArrivalUTCOffset?void 0:c[a].attributes.ArrivalTime,strings:c[a].attributes.DisplayText?[{string:c[a].attributes.DisplayText,stringType:"esriDSTGeneral"}]:[],point:{x:c[a].geometry.x,y:c[a].geometry.y}}),a++;return b});for(f=0;f<c.length;f++)if(c[f].attributes.DirectionPointType=this._itemCodeToItemString(c[f].attributes.DirectionPointType),c[f].attributes.StopSequence)for(var n=0;n<e.length;n++)e[n].attributes.Sequence===c[f].attributes.StopSequence&&
(c[f]._associatedStopRecord=e[n]);for(f=0;f<c.length;f++)if(e=c[f].attributes.DirectionPointType,0===e.indexOf("esriDPTManeuver")||"esriDPTUnknown"===e)n=k(c[f].attributes.Sequence),e={attributes:{length:this.fromMeters(n&&n.attributes.Meters||c[f]._associatedStopRecord&&c[f]._associatedStopRecord.attributes.ServiceMeters||0,g),time:this.fromMinutes(n&&n.attributes.Minutes||c[f]._associatedStopRecord&&c[f]._associatedStopRecord.attributes.ServiceMinutes||0,b),text:c[f].attributes.DisplayText,ETA:this.toGeolocalTime(c[f].attributes.ArrivalTime,
c[f].attributes.ArrivalUTCOffset),arriveTimeUTC:null===c[f].attributes.ArrivalUTCOffset?void 0:c[f].attributes.ArrivalTime,maneuverType:this._itemToManeuverType(e),_stopSequence:c[f].attributes.StopSequence},geometry:n?n.geometry:{paths:[[[c[f].geometry.x,c[f].geometry.y],[c[f].geometry.x,c[f].geometry.y]]],spatialReference:h},strings:function(){var a=[],b=c[f].attributes;b.Name&&a.push({string:b.Name,stringType:"esriDSTStreetName"});b.AlternateName&&a.push({string:b.Name,stringType:"esriDSTAltName"});
b.ExitName&&a.push({string:b.Name,stringType:"esriDSTExit"});b.IntersectingName&&a.push({string:b.Name,stringType:"esriDSTCrossStreet"});b.BranchName&&a.push({string:b.Name,stringType:"esriDSTBranch"});b.TowardName&&a.push({string:b.Name,stringType:"esriDSTToward"});return a}(),events:l(c[f].attributes.Sequence)},0===e.strings.length&&delete e.strings,d.push(e);return d},_generateFeatureCollectionTemplate:function(c,a,e){return{layerDefinition:{name:c,title:a,geometryType:e,objectIdField:"__OBJECTID",
type:"Feature Layer",typeIdField:"",drawingInfo:{fixedSymbols:!0},fields:[{name:"__OBJECTID",alias:"OBJECTID",type:"esriFieldTypeOID",editable:!1,nullable:!1,domain:null}],types:[],capabilities:"Query,Update"},featureSet:{features:[],geometryType:e}}},_createField:function(c,a,e,g,b,h){return"integer"===e?{name:c,alias:a,type:"esriFieldTypeInteger",editable:!0,nullable:!0,visible:!!g,domain:b}:"double"===e?{name:c,alias:a,type:"esriFieldTypeDouble",editable:!0,nullable:!0,visible:!!g,domain:b}:"date"===
e?{name:c,alias:a,type:"esriFieldTypeDate",length:36,editable:!0,nullable:!0,visible:!!g,domain:b}:{name:c,alias:a,type:"esriFieldTypeString",length:h||255,editable:!0,nullable:!0,visible:!!g,domain:b}},_itemToManeuverType:function(c){switch(c){case "esriDPTManeuverArrive":return"esriDMTStop";case "esriDPTManeuverDepart":return"esriDMTDepart";case "esriDPTManeuverDoor":return"esriDMTDoorPassage";case "esriDPTManeuverBearLeft":return"esriDMTBearLeft";case "esriDPTManeuverBearRight":return"esriDMTBearRight";
case "esriDPTManeuverElevator":case "esriDPTManeuverElevatorUp":case "esriDPTManeuverElevatorDown":return"esriDMTElevator";case "esriDPTManeuverEscalator":case "esriDPTManeuverEscalatorDown":case "esriDPTManeuverEscalatorUp":return"esriDMTEscalator";case "esriDPTManeuverFerryOn":return"esriDMTFerry";case "esriDPTManeuverFerryOff":return"esriDMTEndOfFerry";case "esriDPTManeuverForkCenter":return"esriDMTForkCenter";case "esriDPTManeuverForkLeft":return"esriDMTForkLeft";case "esriDPTManeuverForkRight":return"esriDMTForkRight";
case "esriDPTManeuverPedestrianRamp":return"esriDMTPedestrianRamp";case "esriDPTManeuverRampLeft":return"esriDMTRampLeft";case "esriDPTManeuverRampRight":return"esriDMTRampRight";case "esriDPTManeuverRoundabout":case "esriDPTManeuverRoundaboutLeft":case "esriDPTManeuverRoundaboutRight":return"esriDMTRoundabout";case "esriDPTManeuverTurnLeft":return"esriDMTTurnLeft";case "esriDPTManeuverTurnLeftLeft":return"esriDMTLeftLeft";case "esriDPTManeuverTurnLeftRight":return"esriDMTLeftRight";case "esriDPTManeuverTurnRight":return"esriDMTTurnRight";
case "esriDPTManeuverTurnRightLeft":return"esriDMTRightLeft";case "esriDPTManeuverTurnRightRight":return"esriDMTRightRight";case "esriDPTManeuverSharpLeft":return"esriDMTSharpLeft";case "esriDPTManeuverSharpRight":return"esriDMTSharpRight";case "esriDPTManeuverStraight":return"esriDMTStraight";case "esriDPTManeuverStairs":case "esriDPTManeuverStairsUp":case "esriDPTManeuverStairsDown":return"esriDMTStrairs";case "esriDPTManeuverUTurn":case "esriDPTManeuverUTurnLeft":case "esriDPTManeuverUTurnRight":return"esriDMTUTurn"}return"esriDMTUnknown"},
_itemStringToItemCode:function(c){switch(c){case "esriDPTHeader":return 1;case "esriDPTManeuverArrive":return 50;case "esriDPTManeuverDepart":return 51;case "esriDPTManeuverStraight":return 52;case "esriDPTManeuverFerryOn":return 100;case "esriDPTManeuverFerryOff":return 101;case "esriDPTManeuverForkCenter":return 102;case "esriDPTManeuverRoundabout":return 103;case "esriDPTManeuverUTurn":return 104;case "esriDPTManeuverDoor":return 150;case "esriDPTManeuverStairs":return 151;case "esriDPTManeuverElevator":return 152;
case "esriDPTManeuverEscalator":return 153;case "esriDPTManeuverPedestrianRamp":return 154;case "esriDPTManeuverForkLeft":return 200;case "esriDPTManeuverRampLeft":return 201;case "esriDPTManeuverRoundaboutLeft":return 202;case "esriDPTManeuverUTurnLeft":return 203;case "esriDPTManeuverBearLeft":return 204;case "esriDPTManeuverTurnLeft":return 205;case "esriDPTManeuverSharpLeft":return 206;case "esriDPTManeuverTurnLeftLeft":return 207;case "esriDPTManeuverTurnLeftRight":return 208;case "esriDPTManeuverForkRight":return 300;
case "esriDPTManeuverRampRight":return 301;case "esriDPTManeuverRoundaboutRight":return 302;case "esriDPTManeuverUTurnRight":return 303;case "esriDPTManeuverBearRight":return 304;case "esriDPTManeuverTurnRight":return 305;case "esriDPTManeuverSharpRight":return 306;case "esriDPTManeuverTurnRightLeft":return 307;case "esriDPTManeuverTurnRightRight":return 308;case "esriDPTManeuverElevatorUp":return 400;case "esriDPTManeuverEscalatorUp":return 401;case "esriDPTManeuverStairsUp":return 402;case "esriDPTManeuverElevatorDown":return 500;
case "esriDPTManeuverEscalatorDown":return 501;case "esriDPTManeuverStairsDown":return 502;case "esriDPTEvent":return 1E3;case "esriDPTEventLandmark":return 1001;case "esriDPTEventTimeZone":return 1002;case "esriDPTEventTraffic":return 1003;case "esriDPTEventBarrier":return 1004;case "esriDPTEventBoundary":return 1005;case "esriDPTEventRestrictionViolation":return 1006}return 0},_itemCodeToItemString:function(c){switch(c){case 1:return"esriDPTHeader";case 50:return"esriDPTManeuverArrive";case 51:return"esriDPTManeuverDepart";
case 52:return"esriDPTManeuverStraight";case 100:return"esriDPTManeuverFerryOn";case 101:return"esriDPTManeuverFerryOff";case 102:return"esriDPTManeuverForkCenter";case 103:return"esriDPTManeuverRoundabout";case 104:return"esriDPTManeuverUTurn";case 150:return"esriDPTManeuverDoor";case 151:return"esriDPTManeuverStairs";case 152:return"esriDPTManeuverElevator";case 153:return"esriDPTManeuverEscalator";case 154:return"esriDPTManeuverPedestrianRamp";case 200:return"esriDPTManeuverForkLeft";case 201:return"esriDPTManeuverRampLeft";
case 202:return"esriDPTManeuverRoundaboutLeft";case 203:return"esriDPTManeuverUTurnLeft";case 204:return"esriDPTManeuverBearLeft";case 205:return"esriDPTManeuverTurnLeft";case 206:return"esriDPTManeuverSharpLeft";case 207:return"esriDPTManeuverTurnLeftLeft";case 208:return"esriDPTManeuverTurnLeftRight";case 300:return"esriDPTManeuverForkRight";case 301:return"esriDPTManeuverRampRight";case 302:return"esriDPTManeuverRoundaboutRight";case 303:return"esriDPTManeuverUTurnRight";case 304:return"esriDPTManeuverBearRight";
case 305:return"esriDPTManeuverTurnRight";case 306:return"esriDPTManeuverSharpRight";case 307:return"esriDPTManeuverTurnRightLeft";case 308:return"esriDPTManeuverTurnRightRight";case 400:return"esriDPTManeuverElevatorUp";case 401:return"esriDPTManeuverEscalatorUp";case 402:return"esriDPTManeuverStairsUp";case 500:return"esriDPTManeuverElevatorDown";case 501:return"esriDPTManeuverEscalatorDown";case 502:return"esriDPTManeuverStairsDown";case 1E3:return"esriDPTEvent";case 1001:return"esriDPTEventLandmark";
case 1002:return"esriDPTEventTimeZone";case 1003:return"esriDPTEventTraffic";case 1004:return"esriDPTEventBarrier";case 1005:return"esriDPTEventBoundary";case 1006:return"esriDPTEventRestrictionViolation"}return"esriDPTUnknown"},_lineTypeStringToLineTypeCode:function(c){switch(c){case "esriDLTSegment":return 1;case "esriDLTManeuverSegment":return 2;case "esriDLTRestrictionViolation":return 3;case "esriDLTBarrier":return 4;case "esriDLTStopAndGoTraffic":return 5;case "esriDLTSlowTraffic":return 6;
case "esriDLTModerateTraffic":return 7}return 0},_lineTypeCodeToLineTypeString:function(c){switch(c){case 1:return"esriDLTSegment";case 2:return"esriDLTManeuverSegment";case 3:return"esriDLTRestrictionViolation";case 4:return"esriDLTBarrier";case 5:return"esriDLTStopAndGoTraffic";case 6:return"esriDLTSlowTraffic";case 7:return"esriDLTModerateTraffic"}return"esriDLTUnknown"}})});